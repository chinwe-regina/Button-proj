(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5817],{169654:function(e,t,s){"use strict";s.d(t,{Z:function(){return v}});var r=s(397458),n=s(652983),l=s(195269),i=s(835093),a=s(14517),o=s(240904),d=s(517659);let u=null;var c=s(219757),h=s(270430),m=s(404077),g=s(774516),p=s(57174),y=s.n(p);function f(e,t){return`${t?"dark+":""}${e}`}let x=new Map,_=async e=>{let{dark:t,deploymentId:s,teamId:r,withReachable:n}=e;await (0,c.Z)(100);let l=`/api/screenshot${(0,d.c)({dark:t,deploymentId:s,teamId:r,withStatus:n})}`,i=(0,m.P)(l,"GET SCREENSHOT"),a=await fetch(l,{headers:{accept:!function(){if(null===u){let e=document.createElement("canvas");u=!!e.getContext("2d")&&e.toDataURL("image/webp").startsWith("data:image/webp")}return u}()?"*/*":"image/webp,image/apng,image/*,*/*;q=0.8"}});if(200!==a.status){try{(0,m.b)(i,await a.text(),a.status)}catch(e){(0,m.b)(i,e,a.status)}throw Error("An error occurred when loading the screenshot.")}(0,m.b)(i,null,200);let o=await a.blob();return[URL.createObjectURL(o),n?"1"===a.headers.get("x-vercel-screenshot-reachable"):null]};var v=n.memo(e=>{var t;let{deployment:s,noBorderRadius:d=!1,withReachable:u=!1,withImageWrapper:c=!0,onReady:m,height:p,width:v,idForLoadingPreview:j,refresh:w,onScreenshotFailed:E=()=>null}=e,{resolvedTheme:b}=(0,l.F)(),[k,C]=(0,n.useState)("idle"),N=(0,g.m)(),{team:Z,isReady:D}=(0,h.t7)(),I=f((null==s?void 0:s.id)??"","dark"===b),[P,R]=(0,n.useState)(s?null===(t=x.get(I))||void 0===t?void 0:t[0]:null),L=f(j??"","dark"===b),[S,T]=(0,n.useState)("");(0,n.useEffect)(()=>{if(s&&s.status&&(D||N)&&"idle"===k){if(x.has(I)){let[e,t]=x.get(I);R(e),C("success"),m&&m(t);return}if(x.has(L)){let[e]=x.get(L);T(e)}C("loading"),_({dark:"dark"===b?"1":"0",deploymentId:s.id,teamId:null==Z?void 0:Z.id,withReachable:u}).then(e=>{let[t,s]=e;R(t),C("success"),x.set(I,[t,s]),m&&m(s)}).catch(()=>{R(null),C("failed")})}},[s,j,Z,k,u,w]);let O=v?{"--width":(0,o.Z)(v)}:{};return"idle"===k||"loading"===k?S.length>0?(0,r.jsx)("div",{className:(0,a.W)(y().imageWrapper,{[y()["no-border-radius"]]:d,[y()["fixed-height"]]:p,[y()["fixed-width"]]:v}),style:p?{"--height":(0,o.Z)(p),...O}:{},children:(0,r.jsx)("img",{alt:`Loading the screenshot for ${null==s?void 0:s.url}...`,className:y().previewImage,src:S})}):(0,r.jsx)(i.O,{className:y().skeleton,height:p||"100%",squared:d,style:p?{}:{paddingTop:"31.25% ",paddingBottom:"31.25% "},width:v||"100%"}):"failed"!==k&&s&&P?c?(0,r.jsx)("div",{className:(0,a.W)(y().imageWrapper,{[y()["no-border-radius"]]:d,[y()["fixed-height"]]:p,[y()["fixed-width"]]:v}),style:p?{"--height":(0,o.Z)(p),...O}:{},children:(0,r.jsx)("img",{alt:`Preview Screenshot of ${s.url}`,className:y().image,src:P})}):(0,r.jsx)("img",{alt:`Preview Screenshot of ${s.url}`,className:y().image,src:P}):E()})},105817:function(e,t,s){"use strict";s.d(t,{q:function(){return I},Z:function(){return P}});var r=s(397458),n=s(652983),l=s(14517),i=s(957717),a=s(270430),o=s(852049),d=s(950429),u=s(486322),c=s(103497),h=s(191947);let m=new Map;window.addEventListener("storage",e=>{e.key&&(null===e.newValue?m.delete(e.key):m.set(e.key,e.newValue))});class g{constructor(e,t){this.key=e,this.defaultValue=t,this.init()}init(){if(!m.has(this.key))try{m.set(this.key,window.localStorage.getItem(this.key))}catch(e){}}reset(){this.set(this.defaultValue)}get(){let e=m.get(this.key);if(!e)return this.defaultValue;try{return JSON.parse(e)}catch(e){return this.defaultValue}}set(e){try{let t=JSON.stringify(e);window.localStorage.setItem(this.key,t),m.set(this.key,t)}catch(e){}}remove(){try{window.localStorage.removeItem(this.key),m.delete(this.key)}catch(e){}}}var p=s(684874),y=s(210699),f=s(545259),x=s(316944),_=s(487554),v=s(342958),j=s(7594),w=s(370900),E=s(57174),b=s.n(E),k=e=>{let{title:t,message:s,link:n,action:l="Learn More",onDismiss:i}=e;return(0,r.jsxs)(v.Z,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,r.jsx)(o.ZP,{Component:"span",h5:!0,children:t}),(0,r.jsx)(j.L,{y:1/3}),(0,r.jsx)(v.Z,{className:b()["error-message"],children:(0,r.jsx)(w.Z,{children:(0,r.jsx)(o.ZP,{Component:"p",noMargin:!0,small:!0,type:"secondary",children:s})})}),(0,r.jsx)(j.L,{y:2/3}),(0,r.jsxs)(v.Z,{row:!0,style:{justifyContent:"center",alignItems:"flex-end"},children:[(0,r.jsx)(x.z,{onClick:i,size:"small",style:{flex:"1"},type:"secondary",children:"Dismiss"}),n?(0,r.jsx)(j.L,{x:.5}):null,n?(0,r.jsx)(_.Z,{href:n,size:"small",style:{flex:"1"},children:l}):null]})]})};let C=["https://vercel.com/","https://zeit.ink/","https://vercel.link/","https://err.sh/","https://github.com/zeit/","https://github.com/vercel/"],N=e=>{let{status:t,link:s}=e;return"string"==typeof s&&C.some(e=>s.startsWith(e))?(0,r.jsx)(_.Z,{href:s,size:"small",type:"secondary",children:"Learn More"}):"QUEUED"===t?(0,r.jsx)(_.Z,{href:s,size:"small",children:"Add Concurrent Builds"}):(0,r.jsx)(x.z,{passthroughOnClick:e=>{var t;e.preventDefault();let s=document.querySelector("[data-status=error]");s&&((null==s?void 0:s.dataset.state)!=="open"&&(null===(t=s.querySelector("button"))||void 0===t||t.click()),s.scrollIntoView({behavior:"smooth"}))},type:"secondary",children:"View Logs"})};var Z=e=>{let{title:t,link:s,message:n,status:l}=e;return(0,r.jsxs)(v.Z,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,r.jsx)(o.ZP,{Component:"span",h5:!0,children:t}),(0,r.jsx)(j.L,{y:1/3}),(0,r.jsx)(v.Z,{className:b()["error-message"],children:(0,r.jsx)(w.Z,{children:(0,r.jsx)(o.ZP,{Component:"p",noMargin:!0,small:!0,type:"secondary",children:n||"Your deployment has failed to build successfully. Please check out the logs for more details."})})}),s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.L,{y:2/3}),(0,r.jsx)(N,{link:s,status:l})]}):null]})},D=s(169654);function I(e){let{deploy:t,showError:s,isInConcurrentBuildsQueue:n}=e,{status:l,errorMessage:d,errorLink:u=""}=t,{isTeam:c,teamSlug:h}=(0,a.t7)(),m=(0,y.Z)(),{user:g,team:p}=m,x=function(e){var t;let s=(0,f.j)(e),r=null==e?void 0:null===(t=e.resourceConfig)||void 0===t?void 0:t.concurrentBuilds;return!!s&&!!r&&s>=r}(p||g);return"ERROR"===l?s?(0,r.jsx)(Z,{link:u,message:d||"Your deployment has failed to build successfully. Please check out the logs for more details.",status:l,title:"Build Failed"}):(0,r.jsx)(o.ZP,{className:b().statusText,small:!0,type:"error",children:"Deployment Failed"}):"FROZEN"===l||"FAILED"===l?(0,r.jsx)(o.ZP,{className:b().statusText,small:!0,type:"secondary",children:"No Screenshot Available"}):"NO_PRODUCTION"===l?(0,r.jsx)(i.u,{className:b().statusText,delay:!1,text:"To deploy to production, push to the Repository Default branch.",children:(0,r.jsx)(o.ZP,{small:!0,type:"secondary",children:"No Production Deployment"})}):"CANCELED"===l?s&&d?(0,r.jsx)(Z,{link:u,message:d||"Deployment canceled.",status:l,title:"Build Canceled"}):(0,r.jsx)(o.ZP,{className:b().statusText,small:!0,type:"secondary",children:"Deployment Canceled"}):"QUEUED"===l?c&&x&&n?(0,r.jsx)(Z,{link:`/teams/${h}/settings/billing#concurrent-builds`,message:"The Deployment will start building once your other Deployments have finished. Add Concurrent Builds to build in parallel.",status:l,title:"Deployment Queued"}):(0,r.jsx)(o.ZP,{className:b().statusText,small:!0,type:"secondary",children:"Waiting for Build to Start…"}):(0,r.jsx)(o.ZP,{className:b().statusText,small:!0,type:"secondary",children:"Waiting for Build to Finish…"})}function P(e){var t;let{deployment:s,ignoreAliasWarning:i=!0,...a}=e,{showError:o=!1,link:c=!0,empty:m=!1,noHighlight:y,noBorder:f,noBorderRadius:x,useDeploymentUrl:_=!1}=a,v=c?null==s?void 0:s.name:void 0,{domain:j}=(0,h.C8)(v),w=j||a.projectDomain||null,[E,C]=function(e){let t=(0,n.useMemo)(()=>e?new g(`show-deployment-warning:${e.uid||e.id}`,!0):null,[e]),[s,r]=(0,n.useState)(()=>{let e=null==t?void 0:t.get();return"boolean"!=typeof e||e});return[s,e=>{null==t||t.set(e),r(e)}]}(s),N=(0,n.useMemo)(()=>{if(!s)return m?{status:"NO_PRODUCTION"}:null;let e=_?s.url:R(s,w);return{id:s.uid||s.id,url:e,status:s.state||s.status||s.readyState,errorMessage:s.readyStateReasonExternal||s.errorMessage,errorLink:s.errorLink,aliasWarning:s.aliasWarning}},[_,s,m,w]),P=!i&&E&&(null==N?void 0:N.status)==="READY"&&(null==N?void 0:null===(t=N.aliasWarning)||void 0===t?void 0:t.code)==="deprecated_now_sh",L=N&&"READY"!==N.status,S=(null==N?void 0:N.status)==="ERROR"||(null==s?void 0:s.aliasError);return(0,r.jsx)("div",{className:(0,l.W)("geist-ratio",b().container,{[b().fallback]:L,[b().secondary]:(null==N?void 0:N.status)==="CANCELED"||(null==N?void 0:N.status)==="QUEUED"||(null==N?void 0:N.status)==="FROZEN"||(null==N?void 0:N.status)==="FAILED",[b().highlight]:!y,[b().error]:S,[b().warning]:P,[b().noProduction]:(null==N?void 0:N.status)==="NO_PRODUCTION",[b()["no-border"]]:f,[b()["no-border-radius"]]:x}),style:{"--ratio":"62.5%"},children:(null==s?void 0:s.aliasError)?(0,r.jsx)(Z,{message:s.aliasError.message,status:"ERROR",title:"Domain Error"}):P?(0,r.jsx)(k,{link:N.aliasWarning.link,message:N.aliasWarning.message,onDismiss:()=>C(!1),title:"Warning"}):L?(0,r.jsx)(I,{deploy:N,isInConcurrentBuildsQueue:null==s?void 0:s.isInConcurrentBuildsQueue,showError:o}):c&&(null==s?void 0:s.url)?(0,r.jsx)(d.r,{href:(0,u.j)(_?s.url:R(s,w)),onClick:()=>{p.co.track(p.s6.DEPLOYMENT_OVERVIEW_CLICKED_SCREENSHOT,{projectId:s.projectId||(null==w?void 0:w.projectId),deploymentId:s.id,deploymentTarget:s.target})},style:{width:"100%"},tab:!0,children:(0,r.jsx)(D.Z,{deployment:N,onScreenshotFailed:()=>(0,r.jsx)(I,{deploy:{...N,status:"FAILED"},isInConcurrentBuildsQueue:s.isInConcurrentBuildsQueue,showError:o}),withReachable:!0,...a})}):(0,r.jsx)(D.Z,{deployment:N,onScreenshotFailed:()=>(0,r.jsx)(I,{deploy:{...N,status:"FAILED"},isInConcurrentBuildsQueue:null==s?void 0:s.isInConcurrentBuildsQueue,showError:o}),withReachable:!0,...a})})}function R(e,t){let s=(null==t?void 0:t.name)||e.url;return!s||(0,c.Z)(s)?e.url:s}},486322:function(e,t,s){"use strict";s.d(t,{j:function(){return n}});var r=s(800865);function n(e){let t=function(e){let t=e.split(".").slice(-2).join(".");return(0,r.Q)(t)?"https:":"http:"}(e);return`${t}//${e}`}},57174:function(e){e.exports={container:"screenshot_container__x18ju",noProduction:"screenshot_noProduction__Mk_CC",error:"screenshot_error__i8AXj",warning:"screenshot_warning__syxWB",errorHeader:"screenshot_errorHeader__pPCaQ",secondary:"screenshot_secondary__f_pwT",fallback:"screenshot_fallback__QbB2T",highlight:"screenshot_highlight__hf_iT","no-border":"screenshot_no-border__iPysS","no-border-radius":"screenshot_no-border-radius__QP3pR",imageWrapper:"screenshot_imageWrapper__Ab258",fixedHeight:"screenshot_fixedHeight__uqqjF",fixedWidth:"screenshot_fixedWidth__tTvzf","fixed-height":"screenshot_fixed-height__8W83A","fixed-width":"screenshot_fixed-width__TcqvW",statusText:"screenshot_statusText___4BBL",image:"screenshot_image__tfvPx",previewImage:"screenshot_previewImage__V3SeC",blurryLoad:"screenshot_blurryLoad__5ugEd","error-message":"screenshot_error-message__3C2Zu"}}}]);