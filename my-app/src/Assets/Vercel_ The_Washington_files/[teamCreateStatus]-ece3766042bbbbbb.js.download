(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94424],{311555:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new/clone/[teamCreateStatus]",function(){return n(509086)}])},169654:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var i=n(397458),r=n(652983),a=n(195269),o=n(835093),l=n(14517),s=n(240904),c=n(517659);let d=null;var u=n(219757),g=n(270430),p=n(404077),h=n(774516),m=n(57174),f=n.n(m);function y(e,t){return`${t?"dark+":""}${e}`}let v=new Map,_=async e=>{let{dark:t,deploymentId:n,teamId:i,withReachable:r}=e;await (0,u.Z)(100);let a=`/api/screenshot${(0,c.c)({dark:t,deploymentId:n,teamId:i,withStatus:r})}`,o=(0,p.P)(a,"GET SCREENSHOT"),l=await fetch(a,{headers:{accept:!function(){if(null===d){let e=document.createElement("canvas");d=!!e.getContext("2d")&&e.toDataURL("image/webp").startsWith("data:image/webp")}return d}()?"*/*":"image/webp,image/apng,image/*,*/*;q=0.8"}});if(200!==l.status){try{(0,p.b)(o,await l.text(),l.status)}catch(e){(0,p.b)(o,e,l.status)}throw Error("An error occurred when loading the screenshot.")}(0,p.b)(o,null,200);let s=await l.blob();return[URL.createObjectURL(s),r?"1"===l.headers.get("x-vercel-screenshot-reachable"):null]};var x=r.memo(e=>{var t;let{deployment:n,noBorderRadius:c=!1,withReachable:d=!1,withImageWrapper:u=!0,onReady:p,height:m,width:x,idForLoadingPreview:T,refresh:j,onScreenshotFailed:S=()=>null}=e,{resolvedTheme:w}=(0,a.F)(),[b,C]=(0,r.useState)("idle"),E=(0,h.m)(),{team:I,isReady:k}=(0,g.t7)(),P=y((null==n?void 0:n.id)??"","dark"===w),[N,A]=(0,r.useState)(n?null===(t=v.get(P))||void 0===t?void 0:t[0]:null),R=y(T??"","dark"===w),[L,O]=(0,r.useState)("");(0,r.useEffect)(()=>{if(n&&n.status&&(k||E)&&"idle"===b){if(v.has(P)){let[e,t]=v.get(P);A(e),C("success"),p&&p(t);return}if(v.has(R)){let[e]=v.get(R);O(e)}C("loading"),_({dark:"dark"===w?"1":"0",deploymentId:n.id,teamId:null==I?void 0:I.id,withReachable:d}).then(e=>{let[t,n]=e;A(t),C("success"),v.set(P,[t,n]),p&&p(n)}).catch(()=>{A(null),C("failed")})}},[n,T,I,b,d,j]);let Z=x?{"--width":(0,s.Z)(x)}:{};return"idle"===b||"loading"===b?L.length>0?(0,i.jsx)("div",{className:(0,l.W)(f().imageWrapper,{[f()["no-border-radius"]]:c,[f()["fixed-height"]]:m,[f()["fixed-width"]]:x}),style:m?{"--height":(0,s.Z)(m),...Z}:{},children:(0,i.jsx)("img",{alt:`Loading the screenshot for ${null==n?void 0:n.url}...`,className:f().previewImage,src:L})}):(0,i.jsx)(o.O,{className:f().skeleton,height:m||"100%",squared:c,style:m?{}:{paddingTop:"31.25% ",paddingBottom:"31.25% "},width:x||"100%"}):"failed"!==b&&n&&N?u?(0,i.jsx)("div",{className:(0,l.W)(f().imageWrapper,{[f()["no-border-radius"]]:c,[f()["fixed-height"]]:m,[f()["fixed-width"]]:x}),style:m?{"--height":(0,s.Z)(m),...Z}:{},children:(0,i.jsx)("img",{alt:`Preview Screenshot of ${n.url}`,className:f().image,src:N})}):(0,i.jsx)("img",{alt:`Preview Screenshot of ${n.url}`,className:f().image,src:N}):S()})},864633:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var i=n(397458),r=n(652983),a=n(895022),o=n(47518),l=n(222226),s=n(797631);let c={github:{normal:{background:"#24292e",border:"#24292e",foreground:"#fff"},hover:{background:"#555",border:"#555",foreground:"#fff"}},gitlab:{iconAutoSize:!0,iconNoColorOverride:!0,normal:{background:"#6b4fbb",border:"#6b4fbb",foreground:"#fff"},hover:{background:"#8367D3",border:"#8367D3",foreground:"#fff"}},bitbucket:{iconAutoSize:!0,iconNoColorOverride:!0,normal:{background:"#0052CC",border:"#0052CC",foreground:"#fff"},hover:{background:"#1668E2",border:"#1668E2",foreground:"#fff"}}},d={github:{width:"20",height:"20",fill:"#fff"},gitlab:{monochrome:!0},bitbucket:{color:"currentColor"}};function u(e){let{gitType:t,loading:n=!1,...u}=e,g=u.href?l.C:o.o,p=(0,r.useMemo)(()=>c[t],[t]),h=(0,r.useMemo)(()=>d[t],[t]);return(0,i.jsx)(g,{disabled:(null==u?void 0:u.disabled)||n,prefix:n?(0,i.jsx)(a.$,{}):(0,i.jsx)(s.Z,{gitType:t,...h}),width:u.width||260,...p,...u})}},478140:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var i=n(121123),r=n(58363),a=n(517659),o=n(406016);async function l(e){let{projectName:t,environmentVariables:n,teamId:l,projectSettings:c,gitRepository:d}=e,u=Object.entries(c).reduce((e,t)=>{let[n,i]=t;return void 0!==i&&(e[n]=i),e},{});try{let e=await (0,r.I)(`${(0,i.HJ)("v6")}${(0,a.c)({teamId:l,withUserCredentials:1})}`,{method:"POST",body:JSON.stringify({name:t,environmentVariables:n,gitRepository:d,...u}),throwOnHTTPError:!0});return e}catch(e){if((0,o.C)(e)){if("invalid_build_command"===e.code||"invalid_output_directory"===e.code)throw s(e,"buildSettings");if(e.key&&e.key.startsWith("environmentVariables"))throw s(e,"envs");if("invalid_project_name"===e.code||"name"===e.key)throw s(e,"projectName")}throw e}}function s(e,t){return Object.assign(Error(e.message),e,{step:t})}},718042:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(121123),r=n(58363),a=n(517659);async function o(e){let{teamId:t,projectName:n,type:o,repoId:l,owner:s,repo:c,ref:d="main",source:u="import",signal:g}=e;return(0,r.I)(`${(0,i.PP)("v13")}${(0,a.c)({teamId:t,skipAutoDetectionConfirmation:1})}`,{method:"POST",signal:g,body:JSON.stringify({gitSource:{type:o,ref:d,repoId:"github"===o?l:void 0,projectId:"gitlab"===o?l:void 0,owner:"bitbucket"===o?s:void 0,slug:"bitbucket"===o?c:void 0},name:n,target:"production",source:u}),throwOnHTTPError:!0})}},239251:function(e,t,n){"use strict";n.d(t,{N:function(){return s}});var i=n(397458),r=n(316944),a=n(789808),o=n(7594),l=n(921949);function s(e){let{integration:t,active:n,onCancel:s,onResumeClick:c}=e,d=(0,l.dD)();return(0,i.jsxs)(a.u.Modal,{active:n,onClickOutside:()=>{},children:[(0,i.jsxs)(a.u.Body,{children:[(0,i.jsxs)(a.u.Title,{children:["Adding ",t.name]}),(0,i.jsx)(o.L,{y:.5}),(0,i.jsx)(a.u.Subtitle,{children:"Please continue setting it up in the separate window."}),!d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.L,{}),(0,i.jsx)(r.z,{onClick:c,width:"100%",children:"Resume Setup"})]})]}),(0,i.jsx)(a.u.Actions,{children:(0,i.jsx)(a.u.Action,{fullWidth:!0,onClick:s,children:"Cancel"})})]})}},93071:function(e,t,n){"use strict";function i(e){var t,n;if("number"==typeof(null===(t=e.resourceConfig)||void 0===t?void 0:t.edgeConfigSize))return 1e3*e.resourceConfig.edgeConfigSize;switch(null===(n=e.billing)||void 0===n?void 0:n.plan){case"enterprise":return 512e3;case"pro":return 64e3;default:return 8e3}}function r(e){var t,n;if("number"==typeof(null===(t=e.resourceConfig)||void 0===t?void 0:t.edgeConfigs))return e.resourceConfig.edgeConfigs;switch(null===(n=e.billing)||void 0===n?void 0:n.plan){case"enterprise":return 10;case"pro":return"trialing"===e.billing.status?1:3;default:return 1}}n.d(t,{HX:function(){return r},iO:function(){return a},io:function(){return i}});let a=52},679219:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var i=n(652983);function r(e){let[t,n]=(0,i.useState)(!1),r=(0,i.useCallback)(()=>{n(!1)},[]),a=(0,i.useCallback)(()=>{n(!0)},[]),[o,l]=(0,i.useState)(0),s=(0,i.useCallback)(()=>{l(e=>e+1)},[l]);return[a,{active:t,onClickOutside:r,key:`${e}${String(o)}`,onAnimationDone:s}]}},970066:function(e,t,n){"use strict";n.d(t,{LI:function(){return c},OL:function(){return s},UL:function(){return l}});var i=n(397458),r=n(14517),a=n(104333),o=n.n(a);let l=e=>{let{children:t,className:n}=e;return(0,i.jsx)("ul",{className:(0,r.W)(o().ul,n),children:t})},s=e=>{let{children:t,className:n}=e;return(0,i.jsx)("ol",{className:(0,r.W)(o().ol,n),children:t})},c=e=>{let{children:t,className:n}=e;return(0,i.jsx)("li",{className:(0,r.W)(o().li,n),children:t})}},5710:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var i=n(652983),r=n(69282),a=n(426326),o=n(65475),l=n(121123),s=n(517659),c=n(58363),d=n(684874);function u(e){let{integration:t,source:n,onSuccess:u,onError:g}=e,p=(0,a.useRouter)(),h=(0,i.useRef)(null),m=async e=>{let i,a,p,{team:m,projects:f,additionalQueryParameters:y={}}=e;if(h.current){h.current.open();return}let v=`${window.location.origin}/integrations/${t.slug}/loading`,_=!1,x=!1,T=async e=>{let{configuration:i,team:r}=e;return d.co.track(d.s6.INTEGRATION_POPUP_INSTALL_FINISHED,{source:n,target:r?"team":"personal-account",integration:{id:t.id,slug:t.slug}}),d.co.track(d.s6.INTEGRATIONS_INSTALL_MODAL_SUCCESS,{source:n}),d.co.track(d.s6.INTEGRATION_INSTALLED,{integration_id:t.id,integration_slug:t.slug,source:n,target:r?"team":"personal-account"}),d.co.track(d.s6.INTEGRATION_INSTALL_SUCCEEDED,{source:n,target:r?"team":"personal-account",integration:{id:t.id,slug:t.slug}}),u({configuration:i,team:r})},j=async e=>{let{id:t,team:n}=e,i=await (0,c.I)(`${l.Ms}/configuration/${t}${(0,s.c)({teamId:null==n?void 0:n.id})}`);i.completedAt||await (0,c.I)(`${l.Ms}/configuration/${t}${(0,s.c)({teamId:null==n?void 0:n.id})}`,{method:"DELETE"})};h.current=new o.Z({id:`install-integration:${t.slug}`,url:v,callbacks:{onOpen:()=>{null==g||g({message:void 0})},onBlocked:()=>{h.current=null,null==g||g({message:"The installation could not be started."}),d.co.track(d.s6.INTEGRATION_POPUP_INSTALL_BLOCKED,{source:n,target:m?"team":"personal-account"})},onPoll:async e=>{var o,u,j;if(!_&&e.location.href===v){_=!0,d.co.track(d.s6.INTEGRATION_POPUP_INSTALL_STARTED,{source:n,target:m?"team":"personal-account",integration:{id:t.id,slug:t.slug}});try{let e=await (0,c.I)(`${l.Ms}/integration/${t.slug}/configuration${(0,s.c)({teamId:null==m?void 0:m.id})}`);e.error||(a=e);let i=await (0,c.I)(a?`${l.Ms}/integration/${t.slug}/configuration/${a.id}${(0,s.c)({teamId:null==m?void 0:m.id})}`:`${l.Ms}/integration/${t.slug}/configuration${(0,s.c)({teamId:null==m?void 0:m.id})}`,{method:"POST",body:JSON.stringify({projects:f,source:n,scopes:t.scopes})});a||(x=!0,a=i.configuration),p=i.authorizationCode}catch(e){null==g||g((0,r.V)(e)?e:{message:"Something went wrong."}),null===(o=h.current)||void 0===o||o.close();return}i=`${window.location.origin}/dashboard/${m?`${m.slug}/`:""}integrations/${a.id}/installed`,e.location.href=`${t.redirectUri}${(0,s.c)({code:p,teamId:null==m?void 0:m.id,configurationId:a.id,source:a.source,...y,next:i})}`}try{_&&e.location.origin+e.location.pathname===i&&(null===(u=h.current)||void 0===u||u.cancelPolling(),await new Promise(e=>window.setTimeout(e,2e3)),await T({configuration:a,team:m}),null===(j=h.current)||void 0===j||j.close())}catch(e){if(e instanceof DOMException&&"SecurityError"===e.name)return;throw e}},onClose:()=>{h.current=null},onAbort:async()=>{h.current=null,null==g||g({message:"The installation was canceled."}),d.co.track(d.s6.INTEGRATION_INSTALL_CANCELED,{source:n,target:m?"team":"personal-account",integration:{id:t.id,slug:t.slug}}),x&&await j({id:a.id,team:m})}}}),h.current.open()},f=async e=>{let i,{team:a,projects:o}=e;try{i=await (0,c.I)(`${l.Ms}/integration/${t.slug}/configuration${(0,s.c)({teamId:null==a?void 0:a.id})}`,{method:"POST",body:JSON.stringify({projects:o})})}catch(e){null==g||g((0,r.V)(e)?e:{message:"Something went wrong."});return}d.co.track(d.s6.INTEGRATION_INSTALL_SUCCEEDED,{source:n,target:a?"team":"personal-account",integration:{id:t.id,slug:t.slug}});let{configuration:u}=i;p.push(`${window.location.origin}/dashboard/
       ${a?`${a.slug}/`:""}integrations/${u.id}`)};return{open:e=>t.redirectUri?m(e):f(e),close:()=>{var e;console.log("close called"),null===(e=h.current)||void 0===e||e.close()}}}},195335:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(426326),r=n.n(i);function a(e){let{as:t,res:n,status:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){if(n){n.writeHead(i||302,{Location:t||e}),n.end();return}if(e.match(/^https?:\/\//)){window.setLocationHref(e);return}if("/"===e[0]&&"/"!==e[1])return a?r().replace(e,t):r().push(e,t);window.setLocationHref(`${window.location.protocol}//${window.location.host}${e}`)}}window.setLocationHref=e=>{window.isRedirecting=!0,window.location.href=e}},509086:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return nf},default:function(){return ny}});var i,r=n(397458),a=n(652983),o=n(14517),l=n(426326),s=n(852872),c=n(132950),d=n(121446),u=n(835093),g=n(333971),p=n(270430),h=n(71299),m=n(494422),f=n(248888),y=n(847144),v=n.n(y),_=n(68751);let x={status:"creating-repo",cloneRepoStatus:"not-started",creatingTeamCollapsed:!1,creatingTeamSkipped:!1,projectId:null,projectName:"",clonedRepo:{id:null,slug:null},repo:{namespace:"",name:"",ownerType:"",gitType:""},deploymentId:null},T=a.createContext({}),j=()=>a.useContext(T);function S(e,t){switch(t.type){case"SET_STATUS":return{...e,status:t.status};case"SET_CREATING_REPO_WITH_TEAM":return{...e,status:"creating-repo-with-team",createdTeamId:t.teamId};case"SET_CLONE_REPO_STATUS":return{...e,cloneRepoStatus:t.cloneRepoStatus};case"SET_TARGET_NAMESPACE":return{...e,repo:{...e.repo,namespace:t.namespace,ownerType:t.ownerType}};case"SET_TARGET_REPO":return{...e,repo:{...e.repo,name:t.name}};case"SET_GIT_TYPE":return{...e,repo:{...e.repo,gitType:t.gitType}};case"SET_PROJECT_ID":return{...e,projectId:t.projectId};case"SET_PROJECT_NAME":return{...e,projectName:t.projectName};case"SET_CLONED_REPO":return{...e,clonedRepo:{id:t.data.id,slug:t.data.slug}};case"SET_DEPLOYMENT_ID":return{...e,deploymentId:t.deploymentId};case"SET_CREATE_TEAM_COLLAPSED":return{...e,creatingTeamCollapsed:t.creatingTeamCollapsed};case"SET_CREATE_TEAM_SKIPPED":return{...e,creatingTeamSkipped:t.creatingTeamSkipped};case"RESET":return x;default:return e}}var w=n(744726);function b(e){let{deployToVercel:t,...n}=e,{dispatch:i}=j(),o=(0,a.useCallback)(()=>{i({type:"SET_CREATE_TEAM_SKIPPED",creatingTeamSkipped:!0}),(0,_._)(t)()},[t,i]);return(0,r.jsx)(w.H,{...n,flowType:"clone",onSkip:o})}var C=n(842859),E=n(342958),I=n(950429),k=n(7594),P=n(34178),N=n(684874),A=n(562475),R=n(210699),L=n(791688),O=n(535645),Z=n.n(O);let $="signup",M=e=>{let{eventLabel:t}=e,{mutate:n}=(0,R.Z)(),{loginWithGitHub:i,loginWithGitLab:a,loginWithBitbucket:o,state:l}=(0,A.aC)($,{onAuthenticated:()=>{n()}}),{loginState:s,loginError:c}=l;return(0,r.jsx)(E.Z,{center:!0,className:Z().login,"data-testid":(0,L.C)("new","get-started"),children:(0,r.jsxs)(E.Z,{flex:"0 0 auto",children:[(0,r.jsx)(d.x,{as:"span",className:Z().description,color:"gray-900",children:"Select a Git provider to continue with:"}),(0,r.jsx)(k.L,{y:4/3}),(0,r.jsx)("div",{className:Z().formContainer,children:(0,r.jsx)(P.Z,{disableEmail:!0,disableSAML:!0,large:!1,loginError:c,loginState:s,loginWithBitbucket:()=>{t&&N.co.track(N.s6.CLICK_EVENT,{click_name:"import_flow_login_click",click_value:"Start with Bitbucket"}),o()},loginWithGitHub:()=>{t&&N.co.track(N.s6.CLICK_EVENT,{click_name:"import_flow_login_click",click_value:"Start with Github"}),i()},loginWithGitLab:()=>{t&&N.co.track(N.s6.CLICK_EVENT,{click_name:"import_flow_login_click",click_value:"Start with Gitlab"}),a()},mode:$})}),(0,r.jsx)(k.L,{y:4/3}),(0,r.jsx)(d.x,{as:"span",className:Z().learnMore,weight:500,children:(0,r.jsxs)(I.r,{href:"/",tab:!0,children:["Learn more about ",g.c5," →"]})})]})})};function D(e){let{eventLabel:t}=e;return(0,r.jsx)(E.Z,{gap:!1,children:(0,r.jsx)(E.Z,{flex:"1 1 auto",children:(0,r.jsx)(M,{eventLabel:t})})})}var H=n(353729),U=n(403873),G=n(316944),V=n(755159),W=n(359490),z=n(793356),K=n(121123),q=n(464287),B=n(133867),F=n(34356),J=n(407560),Y=n(878593),X=n(308718),Q=n(426476),ee=n(58363),et=n(517659),en=n(920210),ei=n.n(en);function er(e){let{deploymentData:t,installedIntegration:n,onCancelSuccess:i,dispatch:o,configurationId:l,projectId:s,mutateConfigurationsData:d}=e,[u,g]=(0,a.useState)(!1),h=(0,V.e1)(),{team:m}=(0,p.t7)();async function f(){if(!t||(null==t?void 0:t.readyState)==="READY"){g(!1);return}let e=(null==m?void 0:m.id)?`?teamId=${m.id}`:"",n=await (0,ee.I)(`${(0,K.PP)("v12")}/${t.id}/cancel`+e,{throwOnHTTPError:!1,method:"PATCH"});"CANCELED"===n.readyState&&(h.success("Deployment canceled."),i&&i()),g(!1)}let y=async()=>{if(g(!0),l){var e,t;let n=await (0,ee.I)(`${K.Ms}/configuration/${l}${(0,et.c)({teamId:null==m?void 0:m.id})}`);(null===(e=n.projects)||void 0===e?void 0:e.length)>1?await (0,ee.I)(`${K.Ms}/configuration/${l}${(0,et.c)({teamId:null==m?void 0:m.id})}`,{method:"PATCH",body:JSON.stringify({projects:n.projects.filter(e=>e!==s)})}):(null===(t=n.projects)||void 0===t?void 0:t[0])===s&&await (0,ee.I)(`${K.Ms}/configuration/${l}${(0,et.c)({teamId:null==m?void 0:m.id})}`,{method:"DELETE"})}await d(),o({type:"SET_STATUS",status:"installing-integrations-started"}),f()};return(0,r.jsx)(W.JH,{actions:(0,r.jsx)(E.Z,{gap:.5,row:!0,children:(0,r.jsx)(G.z,{disabled:u,loading:u,onClick:y,size:"small",type:"secondary",children:"Change"})}),className:ei().main,thumbnail:(0,r.jsx)(W.bL,{size:24,children:n?(0,r.jsx)(Q.qE,{hash:null==n?void 0:n.icon,size:32}):(0,r.jsx)(c.K,{align:"center",className:ei().noIntegrationsInstalledOuterCircle,justify:"center",children:(0,r.jsx)("div",{className:ei().noIntegrationsInstalledInnerCircle})})}),children:(0,r.jsx)(W.Sn,{description:(null==n?void 0:n.shortDescription)||"No Integrations added",title:(null==n?void 0:n.website)?(0,r.jsx)(I.r,{external:!0,href:null==n?void 0:n.website,children:null==n?void 0:n.name}):(null==n?void 0:n.name)?null==n?void 0:n.name:""})})}var ea=n(718042);let eo=async e=>{let{scopeId:t,gitNamespaces:n,currentNamespace:i}=e,r=null==n?void 0:n.find(e=>e.name===i);t&&r&&await (0,ee.I)(K.zh,{method:"PATCH",body:JSON.stringify({scopeId:t,gitNamespaceId:r.id})})};var el=n(815198),es=n.n(el),ec=n(700246),ed=n(840905),eu=n(940215),eg=n(5710),ep=n(239251),eh=n(60043),em=n.n(eh);function ef(e){let{integration:t,projectId:n,externalId:i,onInstall:s,loading:c}=e,{active:d}=(0,F.R)(),{team:u}=(0,R.Z)(),g=(0,V.e1)(),p=(0,l.useRouter)(),[h,m]=(0,a.useState)(!1),{"skippable-integrations":f}=p.query,{open:y,close:v}=(0,eg.Z)({integration:t,source:"deploy-button",onSuccess:e=>{let{configuration:t}=e;null==s||s(t.id),g.success("Added Integration successfully."),x()},onError:e=>{let{message:t}=e;t&&x()}}),_=async()=>{if(n)return m(!0),y({team:u,projects:[n],additionalQueryParameters:{"external-id":i,currentProjectId:n}})},x=(0,a.useCallback)(()=>(m(!1),v()),[v]),T=(0,o.W)({[em().inactive]:!d});return(0,a.useEffect)(()=>{h&&!d&&x()},[d,x,h]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ep.N,{active:h,integration:t,onCancel:()=>x(),onResumeClick:()=>_()}),(0,r.jsxs)(W.JH,{actions:t.installation?null:(0,r.jsx)(E.Z,{gap:.5,row:!0,children:(0,r.jsx)(G.z,{disabled:!d||c||!n,onClick:()=>void _(),size:"small",children:"Add"})}),className:(0,o.W)(T,{[em().installed]:t.installation}),thumbnail:(0,r.jsx)(W.bL,{size:24,children:(0,r.jsx)(Q.qE,{hash:t.icon,size:32})}),children:[(0,r.jsx)(W.Sn,{description:(0,r.jsx)("span",{className:T,children:t.shortDescription}),title:t.website?(0,r.jsx)(I.r,{href:t.website,tab:!0,children:(0,r.jsxs)(E.Z,{Component:"span",row:!0,vcenter:!0,children:[t.name,(0,r.jsx)(k.L,{inline:!0,x:.3}),(0,r.jsx)(ed.d,{size:16,weight:"bold"}),!f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.L,{inline:!0,x:.3}),(0,r.jsx)(ec.C,{size:"sm",variant:"gray-subtle",children:"Required"})]})]})}):t.name,width:t.installation?"80%":"100%"}),t.installation?(0,r.jsx)(W.Sn,{avatar:(0,r.jsx)(eu.I,{className:"checkmark-icon",color:d?"var(--geist-success)":"var(--accounts-3)",fill:!0}),right:!0}):null]})]})}function ey(e){let{projectId:t,integrationIds:n,installationIds:i,externalId:s,onInstall:d,deploymentId:u}=e,{projectName:g,status:m,dispatch:f,repo:y,clonedRepo:v,cloneRepoStatus:_}=j(),[{env:x}]=(0,J.Z)(),T=i.length>3,S=(0,l.useRouter)(),{"skippable-integrations":w}=S.query,{data:b}=(0,Y.ZP)(u,{refreshInterval:2e3,refreshWhenHidden:!0}),[C,I]=(0,a.useState)(!1),[P,A]=(0,a.useState)(),[R,L]=(0,a.useState)(),O=n.some(e=>!e.startsWith("oac_")),{data:Z}=(0,H.ZP)(()=>["integrationsByIds",...n],async e=>{let[t,...n]=e,i=await Promise.all(n.map(async e=>{try{let t=await (0,q.Z)(`${K.Ms}/integration/${e}?public=1`);return t}catch(e){}}));return i.filter(Boolean)},{revalidateOnFocus:!1,revalidateOnReconnect:!1}),{data:$,mutate:M}=(0,B.Z)(T?null:t),D=(0,a.useMemo)(()=>null==$?void 0:$.integrations.filter(e=>i.includes(e.id)),[i,$]),Q=(0,a.useMemo)(()=>null==Z?void 0:Z.map(e=>({...e,installation:null==D?void 0:D.find(t=>t.integrationId===e.id)})),[Z,D]),ee=Q&&Q.length>0&&Q.every(e=>e.installation);(0,a.useEffect)(()=>{"installing-integrations-finished"!==m&&"deploying"!==m&&"creating-repo"!==m&&ee&&(N.co.track(N.s6.PROJECT_CREATION_ADDED_ALL_INTEGRATIONS,{version:3}),x?f({type:"SET_STATUS",status:"configure-project"}):f({type:"SET_STATUS",status:"installing-integrations-finished"}))},[ee,f,m,x]);let et=null==Q?void 0:Q.some(e=>e.uiHookUri),{active:en}=(0,F.R)(),{team:ei}=(0,p.t7)(),{user:el}=(0,h.a)(),{data:ec}=(0,X.ZP)({provider:y.gitType}),ed=(0,V.e1)(),eu=async()=>{if("finished"===_&&y.gitType){I(!0);try{if(v.id&&v.slug){let e=await (0,ea.Z)({teamId:null==ei?void 0:ei.id,projectName:g,type:y.gitType,repoId:v.id,owner:y.namespace,repo:v.slug});e.id&&(f({type:"SET_STATUS",status:"deploying"}),f({type:"SET_DEPLOYMENT_ID",deploymentId:e.id}),eo({gitNamespaces:ec,currentNamespace:y.namespace,scopeId:(null==ei?void 0:ei.id)||(null==el?void 0:el.uid)}))}}catch(e){ed.error((0,U.VK)(e))}I(!1)}else f({type:"SET_STATUS",status:"installing-integrations-finished"})};return w&&("deploying"===m||"installing-integrations-finished"===m)?(0,r.jsx)(er,{configurationId:R,deploymentData:b,dispatch:f,installedIntegration:P,mutateConfigurationsData:M,onCancelSuccess:()=>{L(null),A(null)},projectId:t}):(0,r.jsxs)(c.K,{className:(0,o.W)(es()["install-integrations"],en?"":es().inactive),justify:"space-between",children:[(0,r.jsx)("div",{children:T?(0,r.jsx)(z.Z,{children:"Only up to three integrations are allowed for a project."}):O?(0,r.jsx)(z.Z,{error:{message:(0,r.jsx)(r.Fragment,{children:"The `integration-ids` query string parameter can only contain the IDs of Integrations (starting with `oac_`)."}),link:"/docs/integrations/deploy-button/integrations",action:"Learn More"}}):et?(0,r.jsx)(z.Z,{error:{message:"Integrations that have a UI Hook URL configured cannot be rendered. Only the Redirect URL field is allowed.",link:"/docs/integrations/deploy-button/integrations",action:"Learn More"}}):Q?null==Q?void 0:Q.map(e=>(0,r.jsx)(ef,{externalId:s,integration:e,loading:C,onInstall:t=>{d&&d(t),w&&(A(e),L(t),x?f({type:"SET_STATUS",status:"configure-project"}):f({type:"SET_STATUS",status:"installing-integrations-finished"}))},projectId:t},e.id)):Array.from(Array(n.length),(e,t)=>(0,r.jsx)(W.JH,{actions:(0,r.jsx)(E.Z,{className:"geist-hide-on-mobile",gap:.5,row:!0,children:(0,r.jsx)(G.z,{disabled:!0,size:"small",children:"Add"})}),placeholder:!0,thumbnail:(0,r.jsx)(W.bL,{size:32}),children:(0,r.jsx)(W.Sn,{description:"",height:45,title:""})},t))}),(0,r.jsx)(k.L,{y:1}),(0,r.jsx)("div",{className:(0,o.W)(es().skipButton,{[es().showSkippableIntegrations]:!!w,[es().maybeShowSkippableIntegrations]:!S.isReady}),children:(0,r.jsx)(G.z,{disabled:!en||C,loading:C,onClick:eu,size:"small",type:"secondary",children:C?"Skipping...":"Skip"})})]})}var ev=n(889353),e_=n(49698),ex=n(797631);(i||(i={})).TemplateClonedSimple="vercel_templates.v0.template_cloned_simple";let eT={[i.TemplateClonedSimple]:100128},ej=async(e,t,n)=>fetch("/api/stream/internal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({schemaId:e,topic:t,record:n})}).catch(()=>null);var eS=n(74934),ew=n.n(eS);function eb(e){let{from:t,to:n,error:l,provider:s,userId:c}=e,{active:u}=(0,F.R)(),[g,p]=(0,a.useState)(!1),h=(null==l?void 0:l.length)!==0;return(0,a.useEffect)(()=>{if(s&&t&&n&&!g){let e={id:(0,e_.Z)(),event_time:new Date().getTime(),user_id:c||void 0,from:t||void 0,to:n||void 0,is_successful:h||!0};ej(eT[i.TemplateClonedSimple],i.TemplateClonedSimple,e).catch(()=>null),p(!0)}},[s,g,c,t,n,h]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(E.Z,{className:(0,o.W)(ew().cloning,{[ew().inactive]:!u,[ew().error]:!!l}),hcenter:!0,vcenter:!0,children:[(0,r.jsxs)(E.Z,{direction:["column","row","row"],flex:0,gap:0,hcenter:!0,vcenter:!0,children:[(0,r.jsx)(E.Z,{children:(0,r.jsx)(E.Z,{className:ew().avatar,hcenter:!0,vcenter:!0,children:(0,r.jsx)(eE,{height:26,width:26})})}),(0,r.jsxs)("div",{className:ew().lineWrapper,children:[(0,r.jsx)(ev.X,{className:ew().cross,style:{fill:"var(--geist-error)",stroke:"var(--geist-background)"}}),(0,r.jsx)("svg",{className:ew().line,fill:"none",height:"2",viewBox:"0 0 66 2",width:"64",children:(0,r.jsx)("path",{d:"M65 0.625H1",stroke:"var(--accents-3)",strokeDasharray:"3 3",strokeLinecap:"square"})}),(0,r.jsx)("span",{className:ew().indicator})]}),(0,r.jsxs)(E.Z,{children:[(0,r.jsx)(E.Z,{className:(0,o.W)(ew().avatar,ew().enter),hcenter:!0,vcenter:!0,children:(0,r.jsx)(eC,{height:26,provider:s,width:26})}),(0,r.jsx)("div",{className:ew().pulse}),(0,r.jsx)("div",{className:ew().pulse}),(0,r.jsx)("div",{className:ew().pulse})]})]}),(0,r.jsxs)("div",{className:ew().text,children:[(0,r.jsxs)(d.x,{"aria-hidden":l,as:"span",className:ew().meta,color:"gray-900",size:14,style:{opacity:l||!t?0:1,transition:"opacity 150ms ease"},weight:400,children:["Cloning"," ",(0,r.jsxs)(d.x,{as:"strong",weight:500,children:[(0,r.jsx)(eC,{provider:s})," ",t]})," ",n?(0,r.jsxs)(r.Fragment,{children:["to"," ",(0,r.jsxs)(d.x,{as:"strong",style:{display:"inline-flex"},weight:500,children:[(0,r.jsx)("span",{style:{flexShrink:0},children:(0,r.jsx)(eC,{provider:s})}),(0,r.jsx)(k.L,{inline:!0,x:1/6})," ",n]})]}):null]}),(0,r.jsx)(d.x,{"aria-hidden":!l,className:ew().errorMessage,color:"gray-900",style:{opacity:l?1:0,transition:"opacity 150ms ease"},children:l})]})]}),u?(0,r.jsxs)("span",{"aria-live":"assertive",className:"geist-sr-only",role:"status",children:["Cloning ",t," to ",n]}):null]})}function eC(e){let t="github"===e.provider||"gitlab"===e.provider||"bitbucket"===e.provider;return t?(0,r.jsx)(ex.Z,{gitType:e.provider,...e}):(0,r.jsx)(eE,{height:e.height,width:e.width})}function eE(e){let{width:t,height:n}=e;return(0,r.jsx)("svg",{fill:"none",height:n||12,viewBox:"0 0 32 32",width:t||12,children:(0,r.jsx)("path",{d:"M29.3333 25.3333C29.3333 26.0406 29.0524 26.7189 28.5523 27.219C28.0522 27.719 27.3739 28 26.6667 28H5.33333C4.62609 28 3.94781 27.719 3.44771 27.219C2.94762 26.7189 2.66666 26.0406 2.66666 25.3333V6.66667C2.66666 5.95942 2.94762 5.28115 3.44771 4.78105C3.94781 4.28095 4.62609 4 5.33333 4H12L14.6667 8H26.6667C27.3739 8 28.0522 8.28095 28.5523 8.78105C29.0524 9.28115 29.3333 9.95942 29.3333 10.6667V25.3333Z",stroke:"var(--accents-6)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})})}var eI=n(355149),ek=n(154791),eP=n(10123),eN=n(423918),eA=n(612637),eR=n(852049),eL=n(864633),eO=n(85467),eZ=n(921949);function e$(e){let{active:t,account:n,onConnect:i,live:o,hasAccess:l,loading:s}=e,c=(0,eO.Z)({onSuccess:i}),d=a.useCallback(e=>{var t;if(n&&e in n&&(null===(t=n[e])||void 0===t?void 0:t.verified)){i(e);return}(0,_._)(c.open)(e)},[n,i,c]);return(0,r.jsx)(W.D2,{disabled:!t,title:null,children:(0,r.jsxs)(E.Z,{gap:2/3,children:[(0,r.jsxs)(E.Z,{direction:["column","row","row"],gap:1/3,children:[(0,r.jsx)(E.Z,{flex:"0 0 1",children:(0,r.jsx)(u.O,{show:!n||!l,children:(0,r.jsx)(eM,{"data-testid":"github-connect-button",disabled:!n,gitType:"github",loading:s,onClick:()=>d("github"),value:"github",width:108,children:"GitHub"})})}),(0,r.jsx)(E.Z,{flex:"0 0 1",children:(0,r.jsx)(u.O,{show:!n||!l,children:(0,r.jsx)(eM,{disabled:!n||o,gitType:"gitlab",loading:s,onClick:()=>d("gitlab"),value:"gitlab",width:105,children:"GitLab"})})}),(0,r.jsx)(E.Z,{flex:"0 0 1",children:(0,r.jsx)(u.O,{show:!n||!l,children:(0,r.jsx)(eM,{disabled:!n||o,gitType:"bitbucket",loading:s,onClick:()=>d("bitbucket"),value:"bitbucket",width:124,children:"Bitbucket"})})})]}),(0,r.jsx)(E.Z,{children:(0,r.jsx)(eR.ZP,{noMargin:!0,preset:"body-2",type:"success",weight:500,children:(0,r.jsx)(I.r,{href:"/account/login-connections",tab:!0,variant:"highlight",children:"Manage Login Connections →"})})})]})})}function eM(e){let{width:t,...n}=e,i=(0,eZ.dD)();return(0,r.jsx)(eL.Z,{iconOffset:i?null:12,style:{width:i?"100%":`${String(t)}px`},textOffset:i?null:27,width:i?"100%":t,...n})}var eD=n(952567),eH=n.n(eD);function eU(e){let{disabled:t,handleChangeGitRepo:n}=e,{repo:i,clonedRepo:a}=j();return(0,r.jsxs)(E.Z,{className:(0,o.W)(eH().collapsed,"git-input-collapsed"),row:!0,vcenter:!0,children:[(0,r.jsxs)(E.Z,{noWrap:!0,row:!0,vcenter:!0,children:[(null==i?void 0:i.gitType)?(0,r.jsx)(ex.Z,{gitType:i.gitType,height:20,width:20}):null,(0,r.jsx)(k.L,{x:.5}),(0,r.jsxs)(d.x,{className:(0,o.W)("geist-ellipsis",eH().fullRepoName),title:`${null==i?void 0:i.namespace}/${null==a?void 0:a.slug}`,weight:600,children:[null==i?void 0:i.namespace,"/",null==a?void 0:a.slug]})]}),(0,r.jsx)(E.Z,{flex:"0 0 80px",children:(0,r.jsx)(G.z,{disabled:t,onClick:n,size:"small",type:"secondary",children:"Change"})})]})}var eG=n(563399),eV=n(851450),eW=n.n(eV),ez=n(792407),eK=n(767437),eq=n(533673),eB=n(585088),eF=n(732735),eJ=n(640053);function eY(e){let{gitType:t,namespace:n,repo:i,template:o,disabled:l,dispatch:s,error:c,setRepoNameStates:d,loading:g}=e,{data:m,mutate:f,isLoading:y}=(0,X.ZP)({provider:t}),{dispatch:v}=j(),{active:x}=(0,F.R)(),{user:T,isLoading:S}=(0,h.a)(),{team:w,isReady:b}=(0,p.t7)(),C=S||!b||y;a.useEffect(()=>{if(o&&t){let e=i??o;v({type:"SET_TARGET_REPO",name:e}),d(i=>({...i,[t]:[n,e]}))}},[o,s,v,t,n,d,i]);let I=a.useCallback(e=>{let{value:i}=e.currentTarget;s({type:"SET_REPO",gitType:t,namespace:n,repo:i}),v({type:"SET_TARGET_REPO",name:i})},[s,v,t,n]),P=a.useCallback(async e=>{let n=await f(),r=Array.isArray(n)&&n.length>0&&n.find(t=>t.installationId===e)||null;s({type:"SET_REPO",gitType:t,namespace:null==r?void 0:r.name,repo:i}),r&&v({type:"SET_TARGET_NAMESPACE",namespace:r.slug,ownerType:r.ownerType})},[s,v,t,f,i]),{open:N}=(0,eJ.Z)({onSuccess:(0,_._)(P)}),[A,R]=a.useState(!1),L=!y&&m;a.useEffect(()=>{"github"!==t||(null==m?void 0:m.length)||A||!L||(R(!0),N())},[t,m,N,A,L,R]);let O=a.useCallback(e=>{if("select-different-git-provider"===e)s({type:"SET_REPO",gitType:t,namespace:void 0,repo:null}),s({type:"SET_GIT_TYPE",gitType:void 0}),v({type:"SET_TARGET_NAMESPACE",namespace:"",ownerType:""}),v({type:"SET_TARGET_REPO",name:""}),v({type:"SET_GIT_TYPE",gitType:""});else if("install-github"===e)R(!0),N();else if("string"==typeof e){let n="",r=null==m?void 0:m.find(t=>{let{slug:n}=t;return n===e});r&&(n=r.ownerType),s({type:"SET_REPO",gitType:t,namespace:e,repo:i,ownerType:n}),v({type:"SET_TARGET_NAMESPACE",namespace:e,ownerType:n})}},[s,v,t,N,i,m]),Z=m&&[...m.map(e=>({value:e.slug||"",label:e.name||"",prefix:(0,r.jsx)(ex.Z,{gitType:t}),isMenu:!1})),..."github"===t?[{value:"install-github",label:"Add GitHub Account",prefix:(0,r.jsx)(ez.v,{size:14}),isMenu:!0}]:[],{value:"select-different-git-provider",label:"Switch Git Provider",prefix:(0,r.jsx)(eK.a,{size:14}),isMenu:!0}];return a.useEffect(()=>{!n&&m&&m.length>0&&(s({type:"SET_REPO",gitType:t,namespace:m[0].slug,repo:i,ownerType:m[0].ownerType}),v({type:"SET_TARGET_NAMESPACE",namespace:m[0].slug,ownerType:m[0].ownerType}))},[s,v,t,n,i,m]),a.useEffect(()=>{let e=o||"",n=null==m?void 0:m.find(e=>{var t;return null==T?void 0:null===(t=T.preferredScopesAndGitNamespaces)||void 0===t?void 0:t.find(t=>t.scopeId===((null==w?void 0:w.id)||T.uid)&&String(e.id)===String(t.gitNamespaceId))}),i=n??(null==m?void 0:m.find(e=>e.id===parseInt((null==T?void 0:T.importFlowGitNamespaceId)??"")))??(null==m?void 0:m[0]);i&&t&&(v({type:"SET_TARGET_NAMESPACE",namespace:i.slug,ownerType:i.ownerType}),d(n=>({...n,[t]:[i.slug,e]})))},[T,m,v,t,d,w,o]),(0,r.jsxs)(E.Z,{direction:["column","row","row"],gap:0,inline:!0,noWrap:!0,style:{width:"100%"},children:[(0,r.jsx)(E.Z,{flex:"45%",children:(0,r.jsx)(eF.Z,{id:"git-scope-select",value:"Git Scope",withInput:!0,children:C?(0,r.jsx)(u.O,{height:40,width:"100%"}):(0,r.jsxs)(eq.y,{className:"select-git-scope",clearable:!1,disabled:g||l||!Array.isArray(m)&&x,onChange:O,placeholder:"Select Git Scope",value:n,children:[(0,r.jsx)(eq.y.Input,{loading:(null==m?void 0:m.length)===0}),(0,r.jsx)(eq.y.List,{children:null==Z?void 0:Z.map(e=>(0,r.jsx)(eq.y.Option,{isMenu:e.isMenu,prefix:e.prefix,value:e.value,children:e.label},e.value))})]})})}),(0,r.jsx)(k.L,{x:1/3,y:2/3}),(0,r.jsx)(E.Z,{flex:"60%",children:(0,r.jsx)(eF.Z,{id:"repo-name",value:"Repository Name",withInput:!0,children:C?(0,r.jsx)(u.O,{height:40,width:"100%"}):(0,r.jsx)(eB.I,{autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",className:"repository-name",disabled:g||l||!Array.isArray(m)&&x,error:c,id:"repo-name",maxLength:100,onChange:I,placeholder:"my-repository",spellCheck:!1,value:i||"",width:"100%"})})})]})}var eX=n(755412),eQ=n(325026),e0=n(803972),e3=n(10764),e4=n(478140),e1=n(148241),e2=n(329650),e5=n(529018);let e9={"hydrogen-2":"remix"};var e7=n(668348);function e6(e){var t;let{initialGitType:n,live:i=!1,hasAccess:o,disabled:s=!1}=e,{user:c,isLoading:d}=(0,h.a)(),{team:u,teams:g}=(0,p.t7)(),f=null==u?void 0:u.id,y=(0,l.useRouter)(),{account:v,isLoading:x}=(0,eP.Z)(c&&!c.limited?c:null),T=(0,m.L)(),S=(0,V.e1)(),{setRepoNameStates:w,gitError:b,setGitError:C,isPrivate:I,setIsPrivate:P,gitType:A,setGitType:R,setLive:O,loading:Z,setLoading:$,importRepoFromOrgError:M,reset:D}=(0,eG.pT)(a.useCallback(e=>{let{setRepoNameStates:t,gitError:n,setGitError:i,isPrivate:r,setIsPrivate:a,gitType:o,setGitType:l,setLive:s,loading:c,setLoading:d,importRepoFromOrgError:u,reset:g}=e;return{setRepoNameStates:t,gitError:n,setGitError:i,isPrivate:r,setIsPrivate:a,gitType:o,setGitType:l,setLive:s,loading:c,setLoading:d,importRepoFromOrgError:u,reset:g}},[]),eI.Z),H=(0,eG._H)(),W=(0,eG.ir)(),q=a.useRef(!1);a.useEffect(()=>()=>{D()},[D]),a.useEffect(()=>{let{query:{"repository-name":e}}=y,t=(0,eN.P)(e);t&&!q.current&&A&&w(e=>{let n=e[A];return n?{...e,[A]:[n[0],t]}:e})},[A,y,w]),a.useEffect(()=>{R(n)},[]),a.useEffect(()=>{O(i)},[i,O]);let B=a.useRef(!1),{active:Q}=(0,F.R)(),{dispatch:en,status:ei,createdTeamId:er,cloneRepoStatus:el,deploymentId:es}=j(),[{"repository-name":ec}]=(0,J.Z)(),{data:ed}=(0,X.ZP)({provider:A});a.useEffect(()=>{H&&ec&&A&&(w(e=>({...e,[A]:[H,ec]})),en({type:"SET_TARGET_REPO",name:ec}))},[A,H,ec,en,w]);let eu=a.useCallback(e=>{R(e),en({type:"SET_GIT_TYPE",gitType:e})},[en,R]),eg=a.useCallback(e=>{if("SET_REPO"===e.type){if(C(null),e.gitType&&e.namespace){let t=e.gitType;q.current=!0,w(n=>({...n,[t]:[e.namespace,e.repo]}))}}else"SET_GIT_TYPE"===e.type&&(R(e.gitType),en({type:"SET_GIT_TYPE",gitType:e.gitType}))},[en,C,R,w]),ep=function(e){let{gitType:t,setLoading:n,setImportRepoFromOrgError:i}=(0,eG.pT)((0,a.useCallback)(e=>{let{gitType:t,setLoading:n,setImportRepoFromOrgError:i}=e;return{gitType:t,setLoading:n,setImportRepoFromOrgError:i}},[]),eI.Z),r=(0,m.L)(),{user:o}=(0,h.a)(),{url:l}=r??{},{team:s}=(0,p.t7)(),c=(0,eG._H)(),d=(0,eG.ir)(),u=(0,eG.pT)(e=>e.isTeamRepo),g=function(){let e=(0,eG.ir)(),t=(0,eG._H)(),{setLoading:n,gitType:i,isPrivate:r,setGitError:o}=(0,eG.pT)((0,a.useCallback)(e=>{let{setLoading:t,gitType:n,isPrivate:i,setGitError:r}=e;return{setLoading:t,gitType:n,isPrivate:i,setGitError:r}},[]),eI.Z),{dispatch:l}=j();return async()=>{let a;try{a=await (0,ee.I)(`${K.Ms}/git-repo`,{method:"POST",body:JSON.stringify({provider:i,namespace:t,name:e,private:r}),throwOnHTTPError:!0}),l({type:"SET_CLONED_REPO",data:{id:a.id,slug:a.slug}}),N.co.track(N.s6.PROJECT_CREATION_CREATED_GIT_REPOSITORY,{version:3})}catch(e){n(!1),o((0,U.SC)(e));return}return a}}(),f=(0,e7.n)(),y=function(){let e=(0,m.L)(),{setLoading:t,gitType:n,live:i,setGitError:r}=(0,eG.pT)((0,a.useCallback)(e=>{let{setLoading:t,gitType:n,live:i,setGitError:r}=e;return{setLoading:t,gitType:n,live:i,setGitError:r}},[]),eI.Z),o=function(){let e=(0,m.L)(),{data:t}=(0,e2.Z)((null==e?void 0:e.url)||null),[{"root-directory":n}]=(0,J.Z)();return async()=>{let i;if(!(null==e?void 0:e.template)){let r=await (0,e1.D)((0,e5.Z)(e,null==t?void 0:t.defaultBranch,n)).then(e=>{var t;return{framework:null===(t=e.framework)||void 0===t?void 0:t.slug}});i=r.framework}return i}}(),{dispatch:l}=j(),[{"root-directory":s,"output-directory":c,"build-command":d,"dev-command":u,"install-command":g,"ignore-command":p}]=(0,J.Z)();return async a=>{let h,{projectName:m,repoFullPath:f,teamId:y}=a,v=await o();if(!n)return;let _=e9[(null==e?void 0:e.template)||""]||(null==e?void 0:e.template)||v;try{h=await (0,e4.Z)({projectName:m,environmentVariables:[],teamId:y,projectSettings:{framework:_,rootDirectory:s,outputDirectory:c,buildCommand:d,devCommand:u,installCommand:g,commandForIgnoringBuildStep:p,live:i},gitRepository:{type:n,repo:f}}),l({type:"SET_PROJECT_ID",projectId:h.id}),l({type:"SET_PROJECT_NAME",projectName:h.name})}catch(e){t(!1),r((0,U.SC)(e));return}return h}}(),v=function(){let e=(0,eG.pT)((0,a.useCallback)(e=>{let{gitType:t}=e;return t},[])),t=(0,eG._H)(),{team:n}=(0,p.t7)(),{user:i}=(0,h.a)(),{data:r}=(0,X.ZP)({provider:e}),o=(0,V.e1)(),{dispatch:l}=j();return async a=>{let{teamId:s,createdRepo:c,projectName:d}=a;if(e&&t)try{let a=await (0,ea.Z)({teamId:s,projectName:d,type:e,repoId:c.id,owner:t,repo:c.slug});if(a.id){l({type:"SET_STATUS",status:"deploying"}),l({type:"SET_DEPLOYMENT_ID",deploymentId:a.id});try{await eo({gitNamespaces:r,currentNamespace:t,scopeId:(null==n?void 0:n.id)||(null==i?void 0:i.uid)})}catch(e){o.error((0,U.VK)(e))}}}catch(e){o.error((0,U.VK)(e))}}}(),_=(0,e3.J)(),{dispatch:x,creatingTeamCollapsed:T}=j(),[{"integration-ids":S,"production-deploy-hook":w,env:b,stores:C}]=(0,J.Z)();return(0,a.useCallback)(async r=>{if(!c||!d)return;n(!0),i(null);let a=await g();if(!a)return;if(!T&&!s&&(_||u)){x({type:"SET_STATUS",status:"creating-team"});return}let p=c?`${c}/${a.slug}`:`${a.slug}`,h=await f();if(!h)return;let m=await y({projectName:h,repoFullPath:p,teamId:r});if(m){C&&x({type:"SET_STATUS",status:"add-storage-started"}),!C&&S&&x({type:"SET_STATUS",status:"installing-integrations-started"}),C||S||!b||x({type:"SET_STATUS",status:"configure-project"}),x({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"started"}),e.current=!0;try{await (0,eQ.Z)({type:t,source:l,target:p,projectName:h,accountId:r||(null==o?void 0:o.uid),teamId:r,branch:"main"})}catch(e){n(!1),x({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"error"}),await (0,e0.captureError)(e);return}if(w&&await (0,eX.r)(m,r,w,"main"),"gitlab"===t||"bitbucket"===t)try{await (0,ee.I)(`${K.AI}/${m.id}/branch${(0,et.c)({teamId:r})}`,{method:"PATCH",body:JSON.stringify({branch:"main"}),throwOnHTTPError:!0})}catch(e){await (0,e0.captureError)(e)}n(!1),x({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"finished"}),S||b||C||!t||await v({teamId:r,createdRepo:a,projectName:h})}},[c,d,n,i,g,T,s,_,u,f,y,S,b,x,e,w,t,C,l,null==o?void 0:o.uid,v])}(B);a.useEffect(()=>{if(er&&"creating-repo-with-team"===ei&&!Z){let e=(0,_._)(ep);en({type:"SET_STATUS",status:"creating-repo"}),e(er)}},[ei,ep,Z,en,g,er]),a.useEffect(()=>{n&&(R(n),en({type:"SET_GIT_TYPE",gitType:n}))},[en,n,R]);let{data:eh}=(0,Y.ZP)(es,{refreshInterval:2e3,refreshWhenHidden:!0});async function em(){if(!eh||"READY"===eh.readyState)return;let e=f?`?teamId=${f}`:"",t=await (0,ee.I)(`${(0,K.PP)("v12")}/${eh.id}/cancel${e}`,{throwOnHTTPError:!1,method:"PATCH"});"CANCELED"===t.readyState&&S.success("Deployment canceled."),en({type:"SET_DEPLOYMENT_ID",deploymentId:null}),en({type:"SET_STATUS",status:"creating-repo"})}let[ef,ey]=a.useState(!0);a.useEffect(()=>{Array.isArray(ed)&&ey(!1)},[ed]);let ev=null==v?void 0:null===(t=v[A??n??"github"])||void 0===t?void 0:t.verified;return"not-started"!==el||"creating-team"===ei?(0,r.jsx)(eU,{disabled:s,handleChangeGitRepo:()=>{$(!1),B.current=!1,en({type:"SET_STATUS",status:"creating-repo"}),en({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"not-started"});let e=(0,_._)(em);e()}}):d||x||!c||ev&&(A||n&&ef)?(0,r.jsxs)("form",{autoComplete:"off",className:Q?"":eW().inactive,"data-testid":(0,L.C)("git-input","loaded"),noValidate:!0,onSubmit:e=>{e.preventDefault();let t=(0,_._)(ep);t(null==u?void 0:u.id)},children:[(0,r.jsx)(eY,{disabled:s,dispatch:eg,error:b??null,gitType:A,loading:Z,namespace:H||"",repo:W,setRepoNameStates:w,template:null==T?void 0:T.template}),(0,r.jsx)(k.L,{}),(0,r.jsxs)(E.Z,{direction:["column","row","row"],children:[(0,r.jsx)(ek.X,{checked:I,disabled:Z||!Q,onChange:()=>{P(!I)},style:{cursor:"pointer"},children:"Create private Git Repository"}),M?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.L,{}),(0,r.jsx)(z.Z,{error:{message:M,link:"/docs/platform/limits#connecting-a-project-to-a-git-repository"}})]}):null,(0,r.jsx)(k.L,{className:"geist-hide-on-mobile",expand:!0}),(0,r.jsx)(k.L,{className:"geist-show-on-mobile",x:1}),(0,r.jsx)(G.z,{"data-testid":(0,L.C)("git-input","submit"),disabled:!A||!Q||Z||"github"!==A&&i||s||!W,loading:Z,size:"small",children:Z?"Creating...":"Create"})]})]}):c.limited?(0,r.jsx)(eA.Z,{small:!0}):(0,r.jsx)(e$,{active:Q,account:v,onConnect:eu,live:i,hasAccess:o,loading:Z||d})}var e8=n(27783),te=n.n(e8);function tt(e){let{framework:t,children:n}=e,{active:i}=(0,F.R)(),o=(0,m.L)(),l=(0,a.useMemo)(()=>(null==t?void 0:t.logo)?(0,r.jsx)(Q.qE,{className:te().frameworkAvatar,placeholder:!t,size:16,url:t.logo}):(null==o?void 0:o.type)?(0,r.jsx)(ex.Z,{gitType:o.type,height:16,width:16}):null,[t,o]);return(0,r.jsxs)(d.x,{as:"span",color:i?"gray-1000":"gray-900",style:{display:"inline-flex",alignItems:"center",verticalAlign:"bottom"},weight:500,children:[l,"\xa0",n]})}var tn=n(721413),ti=n(562519),tr=n(602755),ta=n(429907),to=n(984655),tl=n(641650),ts=n(564100),tc=n(589293),td=n(895022),tu=n(63005),tg=n(789808),tp=n(268877),th=n(901291),tm=n(617031),tf=n.n(tm),ty=n(904437),tv=n(970066),t_=n(589711),tx=n(93071);function tT(e){let{selectedEdgeConfigId:t,edgeConfigData:n,edgeConfigItems:i,mode:a}=e;if("select"===a&&""!==t&&!i.data)return(0,r.jsx)(c.K,{align:"center",children:(0,r.jsx)(td.$,{})});let o="select"===a&&""!==t&&i.data?i.data.map(e=>e.key):[],l=n?Object.keys(n):[],{added:s,overwritten:u}=l.reduce((e,t)=>(o.includes(t)?e.overwritten.push(t):e.added.push(t),e),{added:[],overwritten:[]});return(0,r.jsxs)("div",{children:[u.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.x,{color:"gray-900",children:"These keys will be overwritten in your Edge Config:"}),(0,r.jsx)(tv.UL,{children:u.map(e=>(0,r.jsx)(tv.LI,{children:(0,r.jsx)(d.x,{as:"span",color:"gray-900",monospace:!0,size:13,children:e})},e))})]}):null,s.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.x,{color:"gray-900",children:"These keys will be added to your Edge Config:"}),(0,r.jsx)(tv.UL,{children:s.map(e=>(0,r.jsx)(tv.LI,{children:(0,r.jsx)(d.x,{as:"span",color:"gray-900",monospace:!0,size:13,children:e})},e))})]}):null]})}function tj(e){let{active:t,envValue:n,onClickOutside:i,projectName:o,setEnvValue:l,onAnimationDone:s,edgeConfigData:u}=e,{team:g,user:p}=(0,R.Z)(),{data:h}=(0,tp.FT)(),m=g||p,f=!!m&&!!h&&h.length>=(0,tx.HX)(m),y=null==h?void 0:h.length,[v,_]=(0,a.useState)((null==n?void 0:n.type)==="new-edge-config"?n.edgeConfigName:""),[x,T]=(0,a.useState)((null==n?void 0:n.type)==="existing-edge-config"?n.edgeConfigId:""),[j,S]=(0,a.useState)((null==n?void 0:n.type)==="existing-edge-config"?"select":"create"),[w,b]=(0,a.useState)(!1),[C,k]=(0,a.useState)(null),P=(0,tp.Zl)(""===x?void 0:x);(0,a.useEffect)(()=>{"number"==typeof y&&y>0&&t&&(null==n?void 0:n.type)!=="new-edge-config"&&S("select")},[y,t,null==n?void 0:n.type]),(0,a.useEffect)(()=>{o.length>0&&_(e=>""===e?`${o.replaceAll("_","-").substr(0,t_.$-6)}-store`:e)},[o]),(0,a.useEffect)(()=>{k(null)},[j]);let N=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),b(!0);let t=v.trim();if(0===t.length){k("Missing value"),b(!1);return}if(t.length>t_.$){k(`May not exceed ${t_.$} characters`),b(!1);return}if(!/^[\w-]+$/.test(t)){k('Slug may contain alphanumeric letters, "_" and "-" only'),b(!1);return}l({type:"new-edge-config",edgeConfigId:null,edgeConfigName:t,error:!1}),b(!1),i()},[l,v,i]),A=(0,a.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),""===x)return;b(!0);let t=null==h?void 0:h.find(e=>e.id===x);t?(l({type:"existing-edge-config",edgeConfigId:t.id,edgeConfigName:t.slug,error:!1}),b(!1),i()):k("Could not find selected Edge Config")},[h,i,x,l]),L=(0,a.useRef)(null);(0,a.useEffect)(()=>{setTimeout(()=>{if(t){var e,n;null===(e=L.current)||void 0===e||e.focus(),null===(n=L.current)||void 0===n||n.select()}},0)},[t]);let O=!!h&&""!==x&&h.every(e=>e.id!==x);return(0,r.jsx)(tg.u.Modal,{active:t,allowOverflow:!0,onAnimationDone:s,onClickOutside:w?()=>void 0:i,width:480,children:(0,r.jsxs)("form",{onSubmit:"create"===j?N:A,children:[(0,r.jsx)(tg.u.Body,{children:(0,r.jsxs)(c.K,{gap:6,children:[(0,r.jsx)(tg.u.Title,{center:!0,children:"Connect Edge Config Store"}),(0,r.jsx)(tg.u.Inset,{last:!0,children:(0,r.jsxs)(c.K,{gap:6,children:[(0,r.jsx)(E.Z,{center:!0,children:(0,r.jsx)(ty.Z,{active:j,items:[{name:"Create new",value:"create",width:110},{name:"Select existing",value:"select",width:136}],onChange:e=>{S(e)}})}),"create"===j?(0,r.jsxs)(c.K,{gap:3,children:[(0,r.jsx)(eB.I,{"aria-label":"Edge Config name",disabled:w||f,error:C,label:"Edge Config name",onChange:e=>{_(e.currentTarget.value),k(null)},placeholder:"my-edge-config-store",ref:L,value:v,width:"100%"}),f?(0,r.jsx)(th.Z,{className:tf()["warning-note"],fill:!0,label:!1,type:"warning",variant:"contrast",children:(0,r.jsxs)(c.K,{align:"center",direction:"row",gap:4,style:{padding:1},children:[(0,r.jsx)(tc.u,{fill:!0,size:"16",style:{flexShrink:0}}),(0,r.jsxs)(c.K,{align:"start",gap:2,children:[(0,r.jsx)(d.x,{as:"p",color:"inherit",children:"You reached the maximum number of Edge Configs for your plan."}),(0,r.jsxs)(d.x,{as:"p",color:"inherit",children:["Select an existing Edge Config, upgrade your plan or"," ",(0,r.jsx)(I.r,{external:!0,href:"https://vercel.com/contact/sales",variant:"blend",children:"contact our sales team"})," ","to request a higher limit."]})]})]})}):null]}):(0,r.jsxs)(c.K,{gap:3,children:[(0,r.jsxs)(tu.P,{label:"Select Edge Config",onChange:e=>{T(e.target.value)},value:x,children:[(0,r.jsx)("option",{disabled:!0,value:"",children:"Select an Edge Config"}),null==h?void 0:h.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.slug," (",e.id,")"]},e.id))]}),C?(0,r.jsx)(z.Z,{error:C}):null,O?(0,r.jsx)(z.Z,{error:"This Edge Config no longer exists"}):null]}),("select"===j?""===x||O:f)?null:(0,r.jsx)(tT,{edgeConfigData:u,edgeConfigItems:P,mode:j,selectedEdgeConfigId:x})]})})]})}),(0,r.jsxs)(tg.u.Actions,{children:[(0,r.jsx)(tg.u.Action,{onClick:w?()=>void 0:i,type:"secondary",children:"Cancel"}),(0,r.jsx)(tg.u.Action,{buttonType:"submit",disabled:"create"===j?""===v.trim()||f||w:""===x||w||!P.data,loading:w,children:"create"===j?"Create":"Select"})]})]})})}var tS=n(269433),tw=n.n(tS);let tb=e=>{let{children:t,hideLabel:n,...i}=e;return n?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)(eF.Z,{...i,children:t})},tC=e=>{let{envName:t,envValue:n,setEnvValue:i,error:o,hideLabels:l,disabled:s,disableEnvName:u=!1,edgeConfigData:g,projectName:p}=e,h=(0,a.useMemo)(()=>(0,ti.FR)(t),[t]),[m,f]=(0,a.useState)([]),[y,v]=function(e){let{edgeConfigData:t,envName:n,envValue:i,projectName:r,setEnvValue:o,createdEdgeConfigs:l,setCreatedEdgeConfigs:s}=e,[c,d]=(0,a.useState)(!1),u=(0,a.useCallback)(()=>{d(!1)},[]),g=(0,a.useCallback)(()=>{d(!0)},[]),[p,h]=(0,a.useState)(0),m=(0,a.useCallback)(()=>{h(e=>e+1)},[h]);return[g,{active:c,envName:n,envValue:i,projectName:r,setEnvValue:o,onClickOutside:u,key:String(p),onAnimationDone:m,edgeConfigData:t,createdEdgeConfigs:l,setCreatedEdgeConfigs:s}]}({envName:t,envValue:n,projectName:p,setEnvValue:i,edgeConfigData:g,createdEdgeConfigs:m,setCreatedEdgeConfigs:f});return(0,r.jsxs)(r.Fragment,{children:[(0,a.createElement)(tj,{...v,key:v.key}),(0,r.jsx)(E.Z,{direction:["column","row","row"],children:(0,r.jsxs)(E.Z,{direction:"row",children:[(0,r.jsx)(E.Z,{children:(0,r.jsx)(tb,{hideLabel:l,id:`env-name-${t}`,value:"Name",withInput:!0,children:(0,r.jsx)(eB.I,{disabled:u||s,height:40,id:`env-name-${t}`,placeholder:"EXAMPLE_NAME",prefix:g?(0,r.jsx)(to.u,{}):void 0,prefixStyling:!g&&void 0,value:t,width:"100%"})})}),(0,r.jsx)(E.Z,{children:(0,r.jsx)(tb,{hideLabel:l,id:`env-value-${t}`,value:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"geist-hide-on-mobile",children:"Value (Will Be Encrypted)"}),(0,r.jsx)("span",{className:"geist-show-on-mobile",children:"Value"})]}),withInput:!0,children:h?(0,r.jsx)(tl.Z,{disabled:!0,height:40,id:`env-value-${t}`,placeholder:"Populated by System",value:"",width:"100%"}):g?(0,r.jsxs)(c.K,{align:"center",direction:"row",gap:2,children:[(0,r.jsx)("div",{children:(0,r.jsx)(G.z,{disabled:s,onClick:()=>{y()},type:"secondary",typeName:"button",children:"Select"})}),o?(0,r.jsx)(d.x,{color:"red-900",children:"Missing"}):null,(0,r.jsx)(d.x,{truncate:!0,children:(null==n?void 0:n.type)==="existing-edge-config"||(null==n?void 0:n.type)==="new-edge-config"?n.edgeConfigName:""})]}):(0,r.jsxs)(c.K,{gap:2,children:[(0,r.jsx)(ts.Z,{className:tw().valueTextarea,disabled:s,errored:!!o,height:40,id:`env-value-${t}`,onChange:e=>{i({type:"text",value:e,error:!1})},placeholder:"YOUR_SECRET_VALUE_GOES_HERE",spellCheck:"false",value:(null==n?void 0:n.value)||"",width:"100%"}),o?(0,r.jsx)(d.x,{color:"red-900",children:"Missing"}):null]})})})]})}),"string"==typeof o&&(0,r.jsx)(E.Z,{style:{paddingTop:"var(--geist-gap-half)"},children:(0,r.jsx)(z.Z,{children:o})})]})};var tE=n(891281),tI=n(770577),tk=n.n(tI),tP=n(287735);async function tN(e,t,n){try{await (0,ti.mT)(e,t,n)}catch(i){if((0,tP.B)(i)&&"ENV_ALREADY_EXISTS"===i.code){let i=await tA(e,n),r=new Set(t.map(e=>e.name));await Promise.all(i.filter(e=>r.has(e.key)).map(t=>tR(e,t.id,n))),await (0,ti.mT)(e,t,n)}else throw i}}async function tA(e,t){let{envs:n}=await (0,ee.I)(`${(0,K.HJ)("v8")}/${encodeURIComponent(e)}/env${(0,et.c)({teamId:t})}`,{throwOnHTTPError:!0});return n}async function tR(e,t,n){await (0,ee.I)(`${(0,K.HJ)("v8")}/${encodeURIComponent(e)}/env/${encodeURIComponent(t)}${(0,et.c)({teamId:n})}`,{method:"DELETE",throwOnHTTPError:!0})}function tL(e){return null!=e}function tO(){let[{env:e,envDescription:t,envLink:n,"edge-config-stores":i}]=(0,J.Z)(),{projectName:o,status:l,deploymentId:s,dispatch:u,repo:g,clonedRepo:f,cloneRepoStatus:y}=j(),{team:v}=(0,p.t7)(),{user:_}=(0,h.a)(),{data:x}=(0,Y.ZP)(s),T=(0,m.L)(),{data:S}=(0,ta.ZP)(null==T?void 0:T.url),[w,b]=(0,a.useState)(null),C=(0,V.e1)(),[E,P]=(0,a.useState)(!1),{active:N}=(0,F.R)(),{data:A}=(0,X.ZP)({provider:g.gitType}),[R,L]=(0,a.useState)(!1);(0,a.useEffect)(()=>{S&&b(S.framework)},[S]);let O=(0,a.useMemo)(()=>{try{return JSON.parse(i)}catch{return null}},[i]),[Z,$]=(0,a.useState)({}),M=(0,a.useMemo)(()=>(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).flatMap(e=>e.split(",")),[e]),D=M.filter(e=>{if((0,ti.FR)(e))return!1;let t=Z[e];return void 0===t||"text"===t.type&&""===t.value.trim()});async function H(e){if(e.preventDefault(),L(!0),D.length>0)return;P(!0);let t=await Promise.all(M.map(async e=>{let t=Z[e];if((0,ti.FR)(e))return{key:e,value:"",target:tr.r.Production};if(!t){P(!1),C.error({text:`Missing value for environment variable "${e}"`});return}switch(t.type){case"text":return{key:e,value:t.value,target:tr.r.Production};case"existing-edge-config":{let n=O?O[e]:void 0;try{let i=await (0,ee.I)(`${K.PL}/${t.edgeConfigId}/token${(0,et.c)({teamId:null==v?void 0:v.id})}`,{method:"POST",throwOnHTTPError:!0,body:{label:"web-app-token"}});n&&await (0,ee.I)(`${K.PL}/${t.edgeConfigId}/items${(0,et.c)({teamId:null==v?void 0:v.id})}`,{method:"PATCH",throwOnHTTPError:!0,body:{items:Object.entries(n).map(e=>{let[t,n]=e;return{operation:"upsert",key:t,value:n}})}});let r=`https://edge-config.vercel.com/${t.edgeConfigId}?token=${i.token}`;return{key:e,value:r,target:tr.r.Production}}catch(n){let t=(0,U.SC)(n);P(!1),"Not Found"===t.message?C.error({text:`Check the ${e} environment variable. It looks like it's connected to a deleted Edge Config.`,timeout:1e4}):C.error((0,U.VK)(n))}return}case"new-edge-config":{let n=O?O[e]:void 0;try{let i=await (0,ee.I)(`${K.PL}${(0,et.c)({teamId:null==v?void 0:v.id})}`,{method:"POST",throwOnHTTPError:!0,body:JSON.stringify({slug:t.edgeConfigName,items:n})}),r=await (0,ee.I)(`${K.PL}/${i.id}/token${(0,et.c)({teamId:null==v?void 0:v.id})}`,{method:"POST",throwOnHTTPError:!0,body:{label:"web-app-token"}}),a=`https://edge-config.vercel.com/${i.id}?token=${r.token}`;return{key:e,value:a,target:tr.r.Production}}catch(e){P(!1),C.error((0,U.VK)(e));return}}default:return}}));if(!t.some(e=>void 0===e)){try{await tN(o,t.filter(tL).map(e=>({...e,name:e.key,target:[tr.r.Production,tr.r.Preview,tr.r.Development]})),null==v?void 0:v.id)}catch(e){P(!1),C.error((0,U.VK)(e));return}if("finished"===y&&g.gitType)try{let e=await (0,ea.Z)({teamId:null==v?void 0:v.id,projectName:o,type:g.gitType,repoId:f.id,owner:g.namespace,repo:f.slug});u({type:"SET_STATUS",status:"deploying"}),u({type:"SET_DEPLOYMENT_ID",deploymentId:e.id}),eo({gitNamespaces:A,currentNamespace:g.namespace,scopeId:(null==v?void 0:v.id)||(null==_?void 0:_.uid)})}catch(e){C.error((0,U.VK)(e))}else u({type:"SET_STATUS",status:"configure-project-finished"});P(!1)}}return"deploying"===l||"configure-project-finished"===l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.L,{}),(0,r.jsx)(tE.Z,{customSettings:{"Environment Variables":!0},deployment:x,framework:w,onCancelSuccess:()=>{u({type:"SET_STATUS",status:"configure-project"})},projectName:o,teamId:null==v?void 0:v.id})]}):(0,r.jsxs)("form",{onSubmit:H,children:[(0,r.jsx)(k.L,{}),(0,r.jsxs)(tn.Z,{open:N,title:"Required Environment Variables",children:[M.map((e,t)=>(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(k.L,{y:.5}),(0,r.jsx)(tC,{disableEnvName:!0,disabled:E||!N,edgeConfigData:O?O[e]:void 0,envName:e,envValue:Z[e]??void 0,error:!!(R&&D.includes(e)),hideLabels:0!==t,projectName:o,setEnvValue:t=>{$(n=>({...n,[e]:t}))}},e)]},e)),t?(0,r.jsxs)(c.K,{align:{sm:"flex-start",md:"center",lg:"center"},direction:{sm:"column",md:"row",lg:"row"},gap:2,justify:"space-between",style:{marginTop:"var(--geist-gap-half)"},children:[(0,r.jsx)(d.x,{className:tk().envDescription,color:"gray-900",children:t}),n?(0,r.jsx)(I.r,{external:!0,href:n,style:{fontSize:14},type:"highlight",children:"Learn More"}):null]}):null]}),(0,r.jsx)(k.L,{}),(0,r.jsx)(c.K,{align:"stretch",children:(0,r.jsx)(G.z,{disabled:!N,loading:E,children:E?"Deploying...":"Deploy"})})]})}var tZ=n(194779),t$=n(196410),tM=n(316902),tD=n.n(tM),tH=n(777289),tU=n(431465),tG=n(51343),tV=n(679219),tW=n(156418),tz=n(834436),tK=n(694241),tq=n(91926),tB=n(59336),tF=n.n(tB);let tJ=tD()(async()=>(await n.e(60139).then(n.bind(n,260139))).CreateStoreLimitReachedWarning,{loadableGenerated:{webpack:()=>[260139]},ssr:!1}),tY=tD()(async()=>(await Promise.all([n.e(19826),n.e(47658),n.e(33504)]).then(n.bind(n,76526))).CloneRedisTemplateModal,{loadableGenerated:{webpack:()=>[76526]},ssr:!1}),tX=tD()(async()=>(await Promise.all([n.e(19826),n.e(4166)]).then(n.bind(n,245821))).ClonePostgresTemplateModal,{loadableGenerated:{webpack:()=>[245821]},ssr:!1}),tQ=tD()(async()=>(await Promise.all([n.e(19826),n.e(85764)]).then(n.bind(n,370267))).CloneBlobTemplateModal,{loadableGenerated:{webpack:()=>[370267]},ssr:!1});function t0(e){let{store:t,storeType:n,active:i,description:a,connections:l,openCreateStore:s,isBeta:u}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(W.JH,{className:(0,o.W)(tF().storeEntity),disabled:!i,thumbnail:(0,r.jsx)(c.K,{align:"center",children:(0,r.jsx)(tW.V,{size:"medium",type:n,useColor:!0})}),children:[(0,r.jsx)(W.Sn,{description:a,title:(0,r.jsxs)(c.K,{direction:"row",gap:2,children:[(0,r.jsx)(d.x,{weight:600,children:(null==t?void 0:t.name)??`${tG.eD[n]}`}),u?(0,r.jsx)(tH.Z,{muted:!0}):null,(0,r.jsx)(ec.C,{variant:"gray-subtle",children:"Required"})]})}),l.includes(n)?(0,r.jsx)(eu.I,{color:"var(--accents-5)",fill:!0,size:20}):(0,r.jsx)(G.z,{"data-testid":(0,L.C)(`add-${n}`,"storage-clone"),onClick:()=>s(n),children:t?"Connect":"Add"})]}),t&&"blob"!==t.type?(0,r.jsx)(W.JH,{className:(0,o.W)(tF().storeEntity,tF().storeEntityEndpoint),children:(0,r.jsx)(W.Sn,{description:"redis"===t.type?function(e){if(!e)return"";try{return new URL(e).hostname}catch(e){return""}}(t.redisRestApiUrl):t.connection.host,title:(0,r.jsx)(d.x,{color:"gray-900",lineHeight:16,size:13,weight:500,children:"Endpoint"})})}):null]})}function t3(e){let{hasIntegrations:t}=e,{isReady:n}=(0,l.useRouter)(),i=(0,tq.q)({storeType:"redis"}),o=(0,tq.q)({storeType:"postgres"}),s=(0,tq.q)({storeType:"blob"}),u={redis:i,postgres:o,blob:s},[g,p]=(0,a.useState)("redis"),[{env:h,stores:m}]=(0,J.Z)(),f=(0,a.useMemo)(()=>{try{let e=Array.isArray(m)?m[0]:m;if(!e)return[];let t=decodeURIComponent(e);return JSON.parse(t)}catch{return[]}},[m]),y=f.find(e=>"kv"===e.type),v=f.find(e=>"postgres"===e.type),_=f.find(e=>"blob"===e.type),{projectName:x,dispatch:T}=j(),S=(0,tU.PY)(x),{active:w}=(0,F.R)(),[b,C]=(0,a.useState)(null),[E,I]=(0,a.useState)(null),[k,P]=(0,a.useState)(null),[N,A]=(0,a.useState)([]),[R,L]=(0,tV.b)("create-redis-store"),[O,Z]=(0,tV.b)("create-postgres-store"),[$,M]=(0,tV.b)("create-blob-store"),[D,H]=(0,tV.b)("create-store-limits-reached");return(0,a.useEffect)(()=>{n&&f.length&&(!y||N.includes("redis"))&&(!_||N.includes("blob"))&&(!v||N.includes("postgres"))&&(t?T({type:"SET_STATUS",status:"installing-integrations-started"}):h?T({type:"SET_STATUS",status:"configure-project"}):T({type:"SET_STATUS",status:"add-storage-finished"}))},[n,N,T,h,_,t,y,v,f]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.K,{children:[y?(0,r.jsx)(t0,{active:w,connections:N,description:(0,r.jsxs)(c.K,{align:"center",direction:"row",gap:1,children:[(0,r.jsx)(d.x,{color:"gray-900",children:"Powered by"}),(0,r.jsx)(tz.A,{size:16}),(0,r.jsx)(d.x,{color:"gray-900",children:" Upstash"})]}),openCreateStore:()=>{p("redis"),u.redis.isLimitReached?D():R()},store:b,storeType:"redis"}):null,v?(0,r.jsx)(t0,{active:w,connections:N,description:(0,r.jsxs)(c.K,{align:"center",direction:"row",gap:1,children:[(0,r.jsx)(d.x,{color:"gray-900",children:"Powered by"}),(0,r.jsx)(tK.c,{size:16}),(0,r.jsx)(d.x,{color:"gray-900",children:" Neon"})]}),isBeta:!0,openCreateStore:()=>{p("postgres"),u.postgres.isLimitReached?D():O()},store:E,storeType:"postgres"}):null,_?(0,r.jsx)(t0,{active:w,connections:N,description:(0,r.jsx)(d.x,{color:"gray-900",children:"Powered by Vercel"}),isBeta:!0,openCreateStore:()=>{p("blob"),u.blob.isLimitReached?D():$()},store:k,storeType:"blob"}):null]}),(0,r.jsx)(tY,{active:L.active,initialEnvPrefix:null==y?void 0:y.envVarPrefix,initialRedis:b,onAnimationDone:L.onAnimationDone,onClickOutside:L.onClickOutside,onConnected:()=>A([...N,"redis"]),onCreated:C,project:S.data},L.key),(0,r.jsx)(tX,{active:Z.active,initialEnvPrefix:null==v?void 0:v.envVarPrefix,initialPostgres:E,onAnimationDone:Z.onAnimationDone,onClickOutside:Z.onClickOutside,onConnected:()=>A([...N,"postgres"]),onCreated:I,project:S.data},Z.key),(0,r.jsx)(tQ,{active:M.active,initialBlob:k,initialEnvPrefix:null==_?void 0:_.envVarPrefix,onAnimationDone:M.onAnimationDone,onClickOutside:M.onClickOutside,onConnected:()=>A([...N,"blob"]),onCreated:P,project:S.data},M.key),(0,r.jsx)(tJ,{...H,limit:u[g].limit,plan:u[g].plan,storeType:g})]})}function t4(){let{cloneRepoStatus:e}=j(),t="started"===e,n="finished"===e,i="error"===e;return(0,a.useMemo)(()=>({isCloningStarted:t,isCloningFinished:n,isCloningError:i}),[i,n,t])}function t1(){let e=(0,l.useRouter)(),{"integration-ids":t}=e.query;return(0,a.useMemo)(()=>"string"==typeof t?t.split(","):[],[t])}var t2=n(826239),t5=n(313003),t9=n.n(t5),t7=n(640413);function t6(e){let{hasAccess:t,teamCreateStatus:n}=e;(0,t$.n)();let{user:i,isLoggedOut:s}=(0,h.a)(),{isTeam:y}=(0,p.t7)(),[x,T]=(0,a.useState)([]),[S,w]=(0,a.useState)(!1),E=(0,l.useRouter)(),{"integration-ids":I,"skippable-integrations":k,env:P,live:N,"create-team-collapsed":A,stores:R}=E.query,{status:L,repo:O,projectId:Z,deploymentId:$,creatingTeamCollapsed:M,dispatch:H}=j(),G=(0,eG.pT)(e=>e.setIsTeamRepo),W=(0,m.L)(),[z,q]=(0,a.useState)(null),B=(0,a.useRef)(!1),J=(0,a.useCallback)((e,t)=>{setTimeout(()=>{var t;null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})},t||500)},[]),Y=(0,a.useRef)(null),Q=(0,a.useRef)(null),en=(0,a.useRef)(!1),ei=(0,a.useRef)(null),er=(0,a.useRef)(!1),el=(0,a.useRef)(null),es=(0,a.useRef)(!1),ec=(0,a.useRef)(null),ed=(0,a.useRef)(!1);(0,a.useEffect)(()=>{"creating-team"!==L||ep.current||(ep.current=!0,J(Y)),"add-storage-started"!==L||en.current||(en.current=!0,J(Q)),"installing-integrations-started"!==L||er.current||(er.current=!0,J(ei)),"configure-project"!==L||es.current||(es.current=!0,J(el)),"deploying"!==L||ed.current||(ed.current=!0,J(ec))},[J,L]);let eu=function(e,t){let{query:{"project-name":n,"production-deploy-hook":i,"root-directory":r,"output-directory":o,"build-command":s,"dev-command":c,"install-command":d,"ignore-command":u,env:g,live:f,stores:y}}=(0,l.useRouter)(),{repo:v,clonedRepo:_,dispatch:x}=j(),T=(0,m.L)(),{user:S}=(0,h.a)(),{team:w}=(0,p.t7)(),{data:b}=(0,e2.Z)((null==T?void 0:T.url)||null),C=(0,V.e1)(),E=t1(),{data:I}=(0,X.ZP)({provider:v.gitType});return(0,a.useCallback)(async()=>{var a;let l,p;if(e(!0),!_.slug)return;let h=v.namespace?`${v.namespace}/${_.slug}`:`${_.slug}`,m=(0,t2.kP)("123456789abcdefghijklmnopqrstuvwxyz",4),j=t9()(n||v.name).slice(0,95);try{await (0,t7.e5)({id:j,teamId:null==w?void 0:w.id}),j=`${j}-${m()}`}catch(e){if((0,tP.B)(e)&&"not_found"!==e.code)return}if(!(null==T?void 0:T.template)){let e=await (0,e1.D)((0,e5.Z)(T,null==b?void 0:b.defaultBranch,r));p=null===(a=e.framework)||void 0===a?void 0:a.slug}try{l=await (0,e4.Z)({projectName:j,environmentVariables:[],teamId:null==w?void 0:w.id,projectSettings:{framework:(null==T?void 0:T.template)||p,live:!!f,rootDirectory:r,outputDirectory:o,buildCommand:s,devCommand:c,installCommand:d,commandForIgnoringBuildStep:u},gitRepository:{type:v.gitType,repo:h}}),x({type:"SET_PROJECT_ID",projectId:l.id}),x({type:"SET_PROJECT_NAME",projectName:l.name})}catch(e){C.error((0,U.VK)(e));return}x({type:"SET_CREATE_TEAM_COLLAPSED",creatingTeamCollapsed:!0}),y&&x({type:"SET_STATUS",status:"add-storage-started"}),!y&&E.length>0&&x({type:"SET_STATUS",status:"installing-integrations-started"}),!y&&0===E.length&&g&&x({type:"SET_STATUS",status:"configure-project"}),x({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"started"}),t.current=!0;try{await (0,eQ.Z)({type:v.gitType,source:null==T?void 0:T.url,target:h,projectName:j,accountId:(null==w?void 0:w.id)||(null==S?void 0:S.uid),teamId:null==w?void 0:w.id,branch:"main"})}catch(e){x({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"error"}),await (0,e0.captureError)(e);return}if(i&&await (0,eX.r)(l,null==w?void 0:w.id,i,"main"),"gitlab"===v.gitType||"bitbucket"===v.gitType)try{await (0,ee.I)(`${K.AI}/${l.id}/branch${(0,et.c)({teamId:null==w?void 0:w.id})}`,{method:"PATCH",body:JSON.stringify({branch:"main"}),throwOnHTTPError:!0})}catch(e){await (0,e0.captureError)(e)}if(x({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"finished"}),0===E.length&&!g&&!y&&v.gitType)try{let e=await (0,ea.Z)({teamId:null==w?void 0:w.id,projectName:j,type:v.gitType,repoId:_.id,owner:v.namespace,repo:_.slug});e.id&&(x({type:"SET_STATUS",status:"deploying"}),x({type:"SET_DEPLOYMENT_ID",deploymentId:e.id}),await eo({gitNamespaces:I,currentNamespace:v.namespace,scopeId:(null==w?void 0:w.id)||(null==S?void 0:S.uid)}))}catch(e){C.error((0,U.VK)(e))}},[e,_.slug,_.id,v.namespace,v.name,v.gitType,n,T,x,E.length,g,t,i,y,null==w?void 0:w.id,null==b?void 0:b.defaultBranch,r,f,o,s,c,d,u,C,null==S?void 0:S.uid,I])}(w,B);(0,C.PU)(),(0,a.useEffect)(()=>()=>{H({type:"RESET"})},[H]),(0,a.useEffect)(()=>{G("team"===O.ownerType)},[O.ownerType,G]);let eg=t1(),ep=(0,a.useRef)(!1);(0,a.useEffect)(()=>{A&&"creating-team"===L&&(R?H({type:"SET_STATUS",status:"add-storage-started"}):eg.length?H({type:"SET_STATUS",status:"installing-integrations-started"}):Array.isArray(P)&&P.length||"string"==typeof P&&P?H({type:"SET_STATUS",status:"configure-project"}):H({type:"SET_STATUS",status:"deploying"}))},[A,H,P,eg.length,L,R]);let eh=(0,a.useRef)(!1);(0,a.useEffect)(()=>{A&&!eh.current&&(eh.current=!0,(0,_._)(eu)())},[A,eu,L]);let em=function(){let e=(0,l.useRouter)(),{"external-id":t}=e.query;return Array.isArray(t)?t[0]:t}(),{isCloningError:ef,isCloningFinished:ev,isCloningStarted:e_}=t4(),ex=(0,a.useMemo)(()=>{if(ef)return"An unexpected error occurred. Our team has already been notified and are working to resolve the issue, please try again shortly."},[ef]),eT=(0,r.jsxs)(u.O,{show:!E.isReady||!t,children:["Integrations let you connect your ",g.c5," Project with third-party services."," ",k?(0,r.jsx)(r.Fragment,{children:"One of the following can be used with"}):(0,r.jsx)(r.Fragment,{children:"The following are required for"}),"\xa0",(0,r.jsx)(tt,{framework:z,children:null==W?void 0:W.fullName}),":"]}),ej=(0,a.useMemo)(()=>{let e=(0,r.jsx)(b,{active:!S&&"creating-team"===L,createTeamCollapsed:M,deployToVercel:eu,required:"team"===O.ownerType});if(!y&&"team"===O.ownerType&&"collapsed"!==n)return e;switch(n){case"hidden":return null;case"collapsed":return(0,r.jsx)(f.X,{});default:return e}},[M,eu,y,O.ownerType,L,n,S]),eS=eg.length>0,ew=(0,a.useMemo)(()=>[e_,ev,ef].some(e=>e),[ef,ev,e_]);return!function(e){let{status:t}=j();(0,a.useEffect)(()=>{"creating-repo"===t&&(e.current=!1)},[e,t])}(B),!function(e){let t=(0,m.L)(),n=(0,l.useRouter)(),{data:i}=(0,e2.Z)((null==t?void 0:t.url)||null),{"root-directory":r}=n.query,{data:o}=(0,ta.ZP)((0,e5.Z)(t,null==i?void 0:i.defaultBranch,r));(0,a.useEffect)(()=>{o&&e(o.framework)},[o])}(q),!function(){let{isCloningFinished:e}=t4(),t=t1(),n=(0,l.useRouter)(),{team:i}=(0,p.t7)(),{status:r,repo:o,projectName:s,clonedRepo:c,dispatch:d}=j(),{env:u}=n.query,g=(0,V.e1)(),{data:m}=(0,X.ZP)({provider:o.gitType}),{user:f}=(0,h.a)();(0,a.useEffect)(()=>{if("add-storage-finished"===r&&e&&!u&&!t.length||"installing-integrations-finished"===r&&e&&!u||"configure-project-finished"===r&&e){let e=(0,_._)(async()=>{if(!o.gitType){g.error("Could not find repository type.");return}d({type:"SET_STATUS",status:"deploying"});try{let e=await (0,ea.Z)({teamId:null==i?void 0:i.id,projectName:s,type:o.gitType,repoId:c.id,owner:o.namespace,repo:o.name});if(e.id){d({type:"SET_DEPLOYMENT_ID",deploymentId:e.id});let t=(0,_._)(eo);t({gitNamespaces:m,currentNamespace:o.namespace,scopeId:(null==i?void 0:i.id)||(null==f?void 0:f.uid)})}}catch(e){g.error((0,U.VK)(e))}});e()}},[r,e,d,o,g,i,s,c,u,m,f,t.length])}(),!function(e){let t=(0,l.useRouter)(),{dispatch:n}=j();(0,a.useEffect)(()=>{if(t.query.finishSetup){let i=(0,_._)(t.push);i({query:{...t.query,finishSetup:void 0}}),n({type:"SET_CREATE_TEAM_COLLAPSED",creatingTeamCollapsed:!0}),n({type:"SET_CLONE_REPO_STATUS",cloneRepoStatus:"started"});let r=(0,_._)(e);r()}},[t])}(eu),(0,r.jsxs)("main",{children:[(0,r.jsx)(F.Z,{className:(0,o.W)({[v().hideGetStarted]:i,[v().maybeHideGetStarted]:!s}),disableScrolling:!0,style:{marginBottom:"var(--geist-gap-double)"},subtitle:(0,r.jsxs)(c.K,{align:"flex-start",gap:3,children:[(0,r.jsx)(d.x,{as:"span",color:"gray-1000",weight:500,children:"Vercel is the easiest way to deploy websites."}),(0,r.jsx)("span",{children:"Log in or sign up to clone and deploy "}),(0,r.jsx)(tt,{children:null==W?void 0:W.fullName})]}),title:"Get Started",children:(0,r.jsx)(D,{eventLabel:"Import Flow"})}),(0,r.jsxs)(c.K,{gap:12,children:[(0,r.jsx)(F.Z,{active:!!(t&&("creating-repo"===L&&!ex||e_||ev||"creating-team"===L)&&"deploying"!==L&&i),className:"create-git-repository",disableScrolling:!0,subtitle:(0,r.jsxs)(r.Fragment,{children:["To ensure you can easily update your project after deploying it, a Git repository must be created. Every push to that Git repository will be deployed automatically.",N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Note:"})," Live is currently only available for GitHub repositories."]}):null]}),title:"Create Git Repository",titleDisabled:"Please Log in or Sign up to continue.",children:(0,r.jsx)(e6,{disabled:S,hasAccess:t,initialGitType:null==i?void 0:i.importFlowGitProvider,live:!!N})}),ej?(0,r.jsx)("div",{ref:Y,children:ej}):null,(0,r.jsx)(F.Z,{active:!!(t&&("add-storage-started"===L||"add-storage-finished"===L||"deploying"===L)),className:(0,o.W)(v().addStorage,{[v().showAddStorage]:!!R,[v().maybeShowAddStorage]:!E.isReady}),ref:Q,subtitle:"Add a store to read and write directly to your project, with zero-config, scalable data at the edge.",title:"Add Storage",titleDisabled:"Complete the Create a Repository step to continue.",children:(0,r.jsx)(t3,{hasIntegrations:!!eg.length})}),(0,r.jsx)(F.Z,{active:!!(t&&("installing-integrations-started"===L||k&&("installing-integrations-finished"===L||"deploying"===L))),className:(0,o.W)(v().integrations,{[v().showIntegrations]:!!I,[v().maybeShowIntegrations]:!E.isReady}),ref:ei,subtitle:eT,title:"Add Integrations",titleDisabled:"Complete the Create a Repository step to continue.",children:(0,r.jsx)(ey,{deploymentId:$,externalId:em,installationIds:x,integrationIds:eg,onInstall:e=>{T(t=>[...t,e])},projectId:Z})}),(0,r.jsx)(F.Z,{active:!!(t&&("configure-project"===L||"configure-project-finished"===L||"deploying"===L)),className:(0,o.W)(v().configureProject,{[v().showConfigureProject]:!!P,[v().maybeShowConfigureProject]:!E.isReady}),ref:el,subtitle:"Please provide values for the required Environment Variables.",title:"Configure Project",titleDisabled:0===eg.length?R?"Complete the Add Store step to continue.":"Complete the Create a Repository step to continue.":"Complete the Integrations step to continue.",children:(0,r.jsx)(tO,{})}),"deploying"!==L&&(0,r.jsx)(F.Z,{active:!!(t&&ew&&(P&&eS&&"configure-project-finished"===L||P&&"configure-project-finished"===L||eS&&"installing-integrations-finished"===L||"creating-repo"===L||"creating-repo-with-team"===L||!eS&&!P&&M)),ref:ec,subtitle:"Preparing Git Repository.",title:"Deploy",children:(0,r.jsx)(eb,{error:ex,from:W?`${W.owner}/${W.name}${W.subdir?`/${W.subdir}`:""}`:null,provider:O.gitType||"github",to:O.namespace&&(e_||ev)?`${O.namespace}/${O.name}`:null,userId:(null==i?void 0:i.uid)||null})}),"deploying"===L&&(0,r.jsx)(tZ.Z,{active:t,deploymentId:$,flow:"clone"})]})]})}var t8=n(888559),ne=n(492711),nt=n(317435),nn=n(960388),ni=n(170491),nr=n(184488),na=n(831092),no=n(96957),nl=n(553026),ns=n(40268),nc=n(195335),nd=n(425290);function nu(e){let{frameworks:t,hasAccess:n,teamCreateStatus:i}=e,{status:s,cloneRepoStatus:c,repo:d,creatingTeamCollapsed:u,creatingTeamSkipped:g}=j(),p=(0,l.useRouter)(),{"integration-ids":h,env:m,storage:f}=p.query,y=(0,a.useMemo)(()=>"hidden"!==i?[{title:`Create a Team${"team"!==d.ownerType?" (Optional)":""}`,active:"creating-repo"!==s&&!(g||u)}]:[],[u,g,d.ownerType,s,i]),_=(0,a.useMemo)(()=>[{title:"Create Git Repository",active:"creating-repo"===s},...y,{title:"Add Storage",active:"add-storage-started"===s||"add-storage-finished"===s,className:(0,o.W)(v().addStorage,{[v().showAddStorage]:!!f,[v().maybeShowAddStorage]:!p.isReady})},{title:"Add Integrations",active:["installing-integrations-started","installing-integrations-finished","configure-project","deploying"].includes(s),className:(0,o.W)(v().integrations,{[v().showIntegrations]:!!h,[v().maybeShowIntegrations]:!p.isReady})},{title:"Configure Project",active:"configure-project"===s||"configure-project-finished"===s,className:(0,o.W)(v().configureProject,{[v().showConfigureProject]:!!m,[v().maybeShowConfigureProject]:!p.isReady})},{title:"Deploy",active:"deploying"===s||"creating-repo"===s&&"not-started"!==c||"creating-team"===s&&"started"!==c||"configure-project-finished"===s&&"started"===c||"installing-integrations-finished"===s&&"started"===c}],[s,y,h,p.isReady,f,m,c]);return(0,r.jsx)(nd.Z,{frameworks:t,hasAccess:n,importType:"clone",steps:_})}var ng=n(350290),np=n.n(ng),nh=n(533019),nm=n.n(nh),nf=!0;function ny(e){var t;let{teamCreateStatus:n,frameworks:i}=e,[u,g]=a.useReducer(S,x),m=(0,l.useRouter)(),f=(0,ni.Z)(["onboarding"]),{isLoading:y,isLoggedOut:v,user:_}=(0,h.a)(),j=(0,na.L)(),{teams:w,team:b}=(0,p.t7)(),{can:C,isLoading:E}=(0,ns.ZP)();(0,a.useEffect)(()=>{(null==_?void 0:_.limited)&&(0,nc.Z)(`/login/scope/${_.username}${(0,et.c)({next:window.location.pathname+window.location.search})}`)},[_]);let P=C(ns.aU.Create,ns._z.Project),{live:A,template:R}=m.query,O=!!(!y&&!v&&!E)&&!P;(0,a.useEffect)(()=>{"deploying"===u.status&&R&&N.co.track(N.s6.TEMPLATE_CLONE,{template_slug:R.toString()})},[u.status,R]),(0,a.useEffect)(()=>{if(w&&m.isReady&&m.query.teamSlug){let e=w.find(e=>e.slug===m.query.teamSlug);if(!e||e.limited){let e={...m.query};delete e.teamSlug,m.replace({pathname:"/new/clone",query:e})}}},[w,m]);let Z=(0,nt.i)("isLoggedIn","hide-get-started","1"),$=(0,nn.W)(["integration-ids"],"show-integrations"),M=(0,nn.W)(["storage"],"show-add-storage"),D=(0,nn.W)(["env"],"show-configure-project"),H=(0,nn.W)(["skippable-integrations"],"show-skippable-integrations"),U=(0,nn.W)(["live"],"show-live",{monitorChanges:!0}),G=A?"/live":f(j),[V,W]=(0,nl.bu)();return(0,r.jsxs)(nl.cH.Provider,{value:u.projectId?{openModalSwitchConfirm:V}:null,children:[(0,r.jsx)(nl.Xe,{active:W.active,callback:W.callback,onAnimationDone:W.onAnimationDone,onClickOutside:W.onClickOutside,teamName:null==b?void 0:b.name},W.key),(0,r.jsxs)(ne.Z,{dashboard:!1,deployment:!1,footer:!1,header:(0,r.jsx)(t8.Z,{}),isMarketingPage:!0,logo:!0,screenClassname:nm().screenStyle,title:"New Project",children:[Z,$,M,D,H,U,(0,r.jsxs)("div",{className:(0,o.W)(nm().cloneMain,{[np().gradientOverlay]:O,[nm().gradientOverlay]:O}),children:[(0,r.jsx)("div",{className:nm().headerSpacer}),(0,r.jsxs)(c.K,{className:(0,o.W)(nm().narrative,"geist-wrapper"),children:[(0,r.jsx)(I.r,{href:G,style:{maxWidth:100,marginLeft:"var(--geist-space-2x-negative)"},children:(0,r.jsxs)(c.K,{align:"center",className:"geist-wrapper",direction:"row",gap:1,children:[(0,r.jsx)(s.X,{color:"var(--accents-6)",size:15}),(0,r.jsx)(d.x,{color:"gray-900",size:14,children:"Back"})]})}),(0,r.jsx)(k.L,{y:.5}),A?(0,r.jsx)(nr.Z,{beta:!0,className:"geist-wrapper",header:"Try Next.js Live.",subheader:"Feel free to try Next.js Live using our Next.js Commerce Starter Kit! We will let you know once it’s available for all Vercel projects."}):(0,r.jsx)(nr.Z,{className:"geist-wrapper",header:"You're almost done.",subheader:"Please follow the steps to configure your Project and deploy it."}),(0,r.jsx)(k.L,{className:"geist-show-on-tablet",y:.5}),(0,r.jsx)(k.L,{className:"geist-hide-on-tablet",y:2})]}),(0,r.jsxs)(T.Provider,{value:{...u,dispatch:g},children:[(0,r.jsxs)(c.K,{className:"geist-wrapper",direction:{sm:"column",md:"column",lg:"row"},gap:{sm:9,md:9,lg:18},children:[(0,r.jsx)("div",{className:nm().sidebarContainer,children:(0,r.jsx)("div",{className:nm().sidebar,children:(0,r.jsx)(nu,{frameworks:i,hasAccess:!O,teamCreateStatus:n})})}),(0,r.jsx)("div",{className:nm().mainContent,children:(0,r.jsx)(t6,{hasAccess:!O,teamCreateStatus:n})})]}),(0,r.jsx)(k.L,{className:"geist-show-on-tablet",y:2}),(0,r.jsx)(k.L,{className:"geist-hide-on-tablet",y:4})]}),!O||(null==_?void 0:_.limited)?null:(0,r.jsx)(no.Z,{action:"create a new Project",actionButton:{text:"Go to Dashboard",link:`/${null==b?void 0:b.slug}`},dataTestId:(0,L.C)("modal","permissions"),role:(null==b?void 0:null===(t=b.membership)||void 0===t?void 0:t.role)||"",teamName:(null==b?void 0:b.name)||""})]})]})]})}},268877:function(e,t,n){"use strict";n.d(t,{Dc:function(){return h},FT:function(){return d},K4:function(){return f},R1:function(){return u},RM:function(){return p},Zl:function(){return g},cE:function(){return m}});var i=n(353729),r=n(652983),a=n(58363),o=n(121123),l=n(517659),s=n(270430),c=n(137225);function d(){var e;let t=(0,c.i)(),n=(0,r.useMemo)(()=>{var e;return null===(e=t.data)||void 0===e?void 0:e.stores.filter(e=>"edge-config"===e.type)},[null===(e=t.data)||void 0===e?void 0:e.stores]);return{data:n}}function u(e,t){let{isReady:n,team:r}=(0,s.t7)();return(0,i.ZP)(()=>e&&n?`${o.PL}/${encodeURIComponent(e)}${(0,l.c)({teamId:null==r?void 0:r.id})}`:null,e=>(0,a.I)(e,{throwOnHTTPError:!0}),t)}function g(e,t){let{isReady:n,team:r}=(0,s.t7)();return(0,i.ZP)(()=>e&&n?`${o.PL}/${encodeURIComponent(e)}/items${(0,l.c)({teamId:null==r?void 0:r.id})}`:null,e=>(0,a.I)(e,{throwOnHTTPError:!0}),t)}function p(e,t){let{isReady:n,team:r}=(0,s.t7)();return(0,i.ZP)(()=>e&&n?`${o.PL}/${encodeURIComponent(e)}/tokens${(0,l.c)({teamId:null==r?void 0:r.id})}`:null,e=>(0,a.I)(e,{throwOnHTTPError:!0}),t)}function h(e,t){let{isReady:n,team:r}=(0,s.t7)();return(0,i.ZP)(e&&n?`${o.PL}/${encodeURIComponent(e)}/backups${(0,l.c)({teamId:null==r?void 0:r.id})}`:null,e=>(0,a.I)(e,{throwOnHTTPError:!0}).then(e=>e.backups),t)}function m(e,t,n){let{isReady:r,team:c}=(0,s.t7)();return(0,i.ZP)(()=>e&&t&&"current"!==t&&r?`${o.PL}/${encodeURIComponent(e)}/backups/${encodeURIComponent(t)}${(0,l.c)({teamId:null==c?void 0:c.id})}`:null,e=>(0,a.I)(e,{throwOnHTTPError:!0}),n)}function f(e){let{edgeConfig:t,project:n}=e;return{...t,type:"edge-config",projectsMetadata:n?[{projectId:n.id,name:n.name,framework:n.framework,id:"",environments:[],environmentVariables:[]}]:[],name:t.slug,billingState:"active",usageQuotaExceeded:!1}}},984655:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(361961);let r=(0,i.H)(`<path d="M23.7914 16.5276C34.1696 16.5276 42.5828 13.7232 42.5828 10.2638C42.5828 6.8044 34.1696 4 23.7914 4C13.4132 4 5 6.8044 5 10.2638C5 13.7232 13.4132 16.5276 23.7914 16.5276Z" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
   <path d="M23.7914 31.1432C13.3517 31.1432 5 28.3454 5 24.8794" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
   <path d="M5 10.2638V39.4949C5 42.9609 13.3517 45.7587 23.7914 45.7587M42.5828 22.5V10.2638" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
   <circle cx="38.7637" cy="38.55" r="16.25" strokeWidth="2"/>
   <path d="M29.505 38.3955V37.5033C30.017 37.5033 30.3721 37.4012 30.5703 37.197C30.7686 36.9928 30.8678 36.6629 30.8678 36.2072V35.2262C30.8678 34.6787 30.9432 34.2407 31.0941 33.9122C31.248 33.5808 31.4611 33.3307 31.7333 33.1621C32.0086 32.9934 32.3341 32.8809 32.7099 32.8247C33.0857 32.7685 33.4971 32.7404 33.9439 32.7404V34.1519C33.5947 34.1519 33.3284 34.1978 33.1449 34.2895C32.9644 34.3783 32.8416 34.5174 32.7765 34.7068C32.7114 34.8932 32.6788 35.13 32.6788 35.417V36.7132C32.6788 36.9381 32.6374 37.1526 32.5545 37.3568C32.4717 37.5581 32.3178 37.7371 32.0929 37.8939C31.868 38.0478 31.5469 38.1706 31.1296 38.2624C30.7124 38.3512 30.1708 38.3955 29.505 38.3955ZM33.9439 43.9753C33.4971 43.9753 33.0857 43.9472 32.7099 43.8909C32.3341 43.8347 32.0086 43.7222 31.7333 43.5536C31.4611 43.3849 31.248 43.1348 31.0941 42.8034C30.9432 42.4749 30.8678 42.0369 30.8678 41.4895V40.504C30.8678 40.0483 30.7686 39.7183 30.5703 39.5141C30.3721 39.31 30.017 39.2079 29.505 39.2079V38.3156C30.1708 38.3156 30.7124 38.3615 31.1296 38.4532C31.5469 38.542 31.868 38.6648 32.0929 38.8217C32.3178 38.9756 32.4717 39.1546 32.5545 39.3588C32.6374 39.56 32.6788 39.7746 32.6788 40.0024V41.2986C32.6788 41.5827 32.7114 41.8179 32.7765 42.0044C32.8416 42.1938 32.9644 42.3329 33.1449 42.4216C33.3284 42.5134 33.5947 42.5592 33.9439 42.5592V43.9753ZM29.505 39.2079V37.5033H31.0986V39.2079H29.505Z" fill="currentColor"/>
   <path d="M39.9177 40.757L39.8689 41.2453C39.8304 41.636 39.7564 42.0251 39.6469 42.4128C39.5404 42.8034 39.4279 43.157 39.3096 43.4737C39.1942 43.7903 39.1009 44.0389 39.0299 44.2194H37.8048C37.8492 44.0448 37.9098 43.8007 37.9868 43.487C38.0637 43.1763 38.1362 42.8271 38.2043 42.4394C38.2723 42.0517 38.3153 41.6567 38.333 41.2542L38.3552 40.757H39.9177ZM39.1276 37.3391C38.8346 37.3391 38.5831 37.2355 38.373 37.0284C38.1658 36.8212 38.0622 36.5697 38.0622 36.2737C38.0622 35.9837 38.1658 35.7366 38.373 35.5324C38.5831 35.3253 38.8346 35.2217 39.1276 35.2217C39.4117 35.2217 39.6602 35.3253 39.8733 35.5324C40.0864 35.7366 40.1929 35.9837 40.1929 36.2737C40.1929 36.472 40.1426 36.6525 40.042 36.8153C39.9443 36.9751 39.8156 37.1023 39.6558 37.197C39.496 37.2917 39.3199 37.3391 39.1276 37.3391Z" fill="currentColor"/>
   <path d="M48.4938 38.3156V39.2079C47.9848 39.2079 47.6297 39.31 47.4285 39.5141C47.2302 39.7183 47.1311 40.0483 47.1311 40.504V41.4895C47.1311 42.0369 47.0541 42.4749 46.9002 42.8034C46.7493 43.1348 46.5362 43.3849 46.261 43.5536C45.9888 43.7222 45.6647 43.8347 45.2889 43.8909C44.916 43.9472 44.5047 43.9753 44.0549 43.9753V42.5592C44.4041 42.5592 44.6689 42.5134 44.8494 42.4216C45.0329 42.3329 45.1572 42.1938 45.2223 42.0044C45.2874 41.8179 45.32 41.5827 45.32 41.2986V40.0024C45.32 39.7746 45.3614 39.56 45.4443 39.3588C45.5271 39.1546 45.681 38.9756 45.9059 38.8217C46.1308 38.6648 46.4519 38.542 46.8692 38.4532C47.2864 38.3615 47.828 38.3156 48.4938 38.3156ZM44.0549 32.7404C44.5047 32.7404 44.916 32.7685 45.2889 32.8247C45.6647 32.8809 45.9888 32.9934 46.261 33.1621C46.5362 33.3307 46.7493 33.5808 46.9002 33.9122C47.0541 34.2407 47.1311 34.6787 47.1311 35.2262V36.2072C47.1311 36.6629 47.2302 36.9928 47.4285 37.197C47.6297 37.4012 47.9848 37.5033 48.4938 37.5033V38.3955C47.828 38.3955 47.2864 38.3512 46.8692 38.2624C46.4519 38.1706 46.1308 38.0478 45.9059 37.8939C45.681 37.7371 45.5271 37.5581 45.4443 37.3568C45.3614 37.1526 45.32 36.9381 45.32 36.7132V35.417C45.32 35.13 45.2874 34.8932 45.2223 34.7068C45.1572 34.5174 45.0329 34.3783 44.8494 34.2895C44.6689 34.1978 44.4041 34.1519 44.0549 34.1519V32.7404ZM48.4938 37.5033V39.2079H46.9002V37.5033H48.4938Z" fill="currentColor"/>`,!1,{viewBox:"0 0 60 60",weight:"light"})},636319:function(e,t,n){"use strict";n.d(t,{M:function(){return r}});var i=n(361961);let r=(0,i.H)('<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><path d="M22 6l-10 7L2 6"/>')},57174:function(e){e.exports={container:"screenshot_container__x18ju",noProduction:"screenshot_noProduction__Mk_CC",error:"screenshot_error__i8AXj",warning:"screenshot_warning__syxWB",errorHeader:"screenshot_errorHeader__pPCaQ",secondary:"screenshot_secondary__f_pwT",fallback:"screenshot_fallback__QbB2T",highlight:"screenshot_highlight__hf_iT","no-border":"screenshot_no-border__iPysS","no-border-radius":"screenshot_no-border-radius__QP3pR",imageWrapper:"screenshot_imageWrapper__Ab258",fixedHeight:"screenshot_fixedHeight__uqqjF",fixedWidth:"screenshot_fixedWidth__tTvzf","fixed-height":"screenshot_fixed-height__8W83A","fixed-width":"screenshot_fixed-width__TcqvW",statusText:"screenshot_statusText___4BBL",image:"screenshot_image__tfvPx",previewImage:"screenshot_previewImage__V3SeC",blurryLoad:"screenshot_blurryLoad__5ugEd","error-message":"screenshot_error-message__3C2Zu"}},920210:function(e){e.exports={main:"add-integrations-collapsed_main__4z_bE",noIntegrationsInstalledOuterCircle:"add-integrations-collapsed_noIntegrationsInstalledOuterCircle__uf2Cb",noIntegrationsInstalledInnerCircle:"add-integrations-collapsed_noIntegrationsInstalledInnerCircle___WVgv"}},59336:function(e){e.exports={storeEntity:"add-storage_storeEntity__KID95",storeEntityEndpoint:"add-storage_storeEntityEndpoint__HIWrg"}},847144:function(e){e.exports={hideGetStarted:"clone-skeletons_hideGetStarted__oQv9v",maybeHideGetStarted:"clone-skeletons_maybeHideGetStarted__9kikd",integrations:"clone-skeletons_integrations__lM9P6",configureProject:"clone-skeletons_configureProject__KF_wx",addStorage:"clone-skeletons_addStorage__PZjGj",liveNarrative:"clone-skeletons_liveNarrative__xmTAb",createTeamCollapsed:"clone-skeletons_createTeamCollapsed__TRIV0",hideWithLiveNarrative:"clone-skeletons_hideWithLiveNarrative__FBh5T",hideCreateTeam:"clone-skeletons_hideCreateTeam__GRFBz",showIntegrations:"clone-skeletons_showIntegrations__Z8L11",showConfigureProject:"clone-skeletons_showConfigureProject__b_JNX",showAddStorage:"clone-skeletons_showAddStorage__oXqvz",maybeShowIntegrations:"clone-skeletons_maybeShowIntegrations__gtdfC",maybeShowConfigureProject:"clone-skeletons_maybeShowConfigureProject__8Vxpd",maybeShowAddStorage:"clone-skeletons_maybeShowAddStorage__cZA8E",backdrop:"clone-skeletons_backdrop__wGDc9"}},74934:function(e){e.exports={cloning:"cloning_cloning__xXZyT",inactive:"cloning_inactive__NKRAw",meta:"cloning_meta__Rjur7",avatar:"cloning_avatar__gKX2u",pulse:"cloning_pulse__9zcxG",indicator:"cloning_indicator__EGKbw",error:"cloning_error__h4Mxi",enter:"cloning_enter__2RgS3",shake:"cloning_shake__1htsN",cross:"cloning_cross__y93xm",text:"cloning_text__s4iA5",errorMessage:"cloning_errorMessage__Zov1Z",lineWrapper:"cloning_lineWrapper__5U_4d",line:"cloning_line__oohS0",slide:"cloning_slide__1hhhG"}},770577:function(e){e.exports={envDescription:"configure-project-env-vars_envDescription__TKjUS"}},269433:function(e){e.exports={valueTextarea:"env-variables-form_valueTextarea__54ARA",envButton:"env-variables-form_envButton__KzED5"}},535645:function(e){e.exports={login:"get-started_login__n6Hp9",description:"get-started_description__o1ZfP",learnMore:"get-started_learnMore__lBAqQ",formContainer:"get-started_formContainer__55Ozw"}},952567:function(e){e.exports={collapsed:"git-input-collapsed_collapsed__YjHMl",fullRepoName:"git-input-collapsed_fullRepoName__P_5Eq"}},851450:function(e){e.exports={inactive:"git-input_inactive__E4FVB"}},815198:function(e){e.exports={"install-integrations":"install-integrations_install-integrations__ygKO3",inactive:"install-integrations_inactive__I5tje",skipButton:"install-integrations_skipButton__dIdvn",showSkippableIntegrations:"install-integrations_showSkippableIntegrations___rveA",maybeShowSkippableIntegrations:"install-integrations_maybeShowSkippableIntegrations__4R4sZ"}},60043:function(e){e.exports={installed:"integration-item_installed__2ZEKt",inactive:"integration-item_inactive__60Wan"}},27783:function(e){e.exports={frameworkAvatar:"main-clone_frameworkAvatar__Ixn8h"}},104333:function(e){e.exports={ul:"list_ul__GYcIA",ol:"list_ol___dUgW",li:"list_li__pr_U4"}},533019:function(e){e.exports={screenStyle:"clone_screenStyle__rFRJG",sidebarContainer:"clone_sidebarContainer__Tzvfg",mainContent:"clone_mainContent__o5QgZ",sidebar:"clone_sidebar__k_5rj",cloneMain:"clone_cloneMain__BqPU2",narrative:"clone_narrative__jb9x8",createTeamStep:"clone_createTeamStep__z9bTi",hideCreateTeamStep:"clone_hideCreateTeamStep__vaaDe",showCreateTeamStep:"clone_showCreateTeamStep__MP008",headerSpacer:"clone_headerSpacer__2SvDp",gradientOverlay:"clone_gradientOverlay__bHQPb"}},350290:function(e){e.exports={screenStyle:"new_screenStyle__92F8b",footer:"new_footer__4ZyIr",logos:"new_logos__KLHxB",optimizedForText:"new_optimizedForText__mcd2E",spacer:"new_spacer__4M1ar"}}},function(e){e.O(0,[82366,47920,31668,70018,69449,49072,55622,76517,66101,26222,18070,22082,88289,57490,92711,56418,2131,50728,62475,72162,86200,34178,68745,90985,49774,92888,40179],function(){return e(e.s=311555)}),_N_E=e.O()}]);